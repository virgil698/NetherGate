# å›½é™…åŒ– (i18n)

NetherGate æä¾›äº†å®Œæ•´çš„å›½é™…åŒ–æ”¯æŒï¼Œè®©ä½ çš„æ’ä»¶å¯ä»¥è½»æ¾æ”¯æŒå¤šè¯­è¨€ã€‚è¯¥åŠŸèƒ½å— [MCDReforged](https://github.com/Fallen-Breath/MCDReforged) å›½é™…åŒ–ç³»ç»Ÿå¯å‘ã€‚

---

## ğŸ“‹ **ç›®å½•**

- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [è¯­è¨€æ–‡ä»¶](#è¯­è¨€æ–‡ä»¶)
- [API ä½¿ç”¨](#api-ä½¿ç”¨)
- [é«˜çº§åŠŸèƒ½](#é«˜çº§åŠŸèƒ½)
- [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)

---

## ğŸš€ **å¿«é€Ÿå¼€å§‹**

### **1. åˆ›å»ºè¯­è¨€æ–‡ä»¶**

åœ¨æ’ä»¶çš„ `lang` ç›®å½•ä¸‹åˆ›å»ºè¯­è¨€æ–‡ä»¶ï¼š

```
MyPlugin/
â”œâ”€â”€ MyPlugin.dll
â””â”€â”€ lang/
    â”œâ”€â”€ zh_CN.json    # ç®€ä½“ä¸­æ–‡
    â”œâ”€â”€ en_US.json    # è‹±è¯­
    â””â”€â”€ ja_JP.json    # æ—¥è¯­
```

### **2. å®šä¹‰ç¿»è¯‘**

**zh_CN.json:**
```json
{
  "commands.welcome": "æ¬¢è¿ {0}ï¼",
  "commands.goodbye": "å†è§ {0}ï¼",
  "messages.server_starting": "æœåŠ¡å™¨æ­£åœ¨å¯åŠ¨...",
  "messages.player_joined": "Â§aç©å®¶ {0} åŠ å…¥äº†æœåŠ¡å™¨",
  "errors.player_not_found": "Â§cç©å®¶ {0} ä¸å­˜åœ¨"
}
```

**en_US.json:**
```json
{
  "commands.welcome": "Welcome {0}!",
  "commands.goodbye": "Goodbye {0}!",
  "messages.server_starting": "Server is starting...",
  "messages.player_joined": "Â§aPlayer {0} joined the server",
  "errors.player_not_found": "Â§cPlayer {0} not found"
}
```

### **3. ä½¿ç”¨ç¿»è¯‘**

```csharp
public class MyPlugin : IPlugin
{
    private II18nService _i18n;
    
    public void OnEnable(IPluginContext context)
    {
        _i18n = context.I18nService;
        
        // ä½¿ç”¨ç¿»è¯‘
        var message = _i18n.Translate("commands.welcome", "Steve");
        // zh_CN: "æ¬¢è¿ Steveï¼"
        // en_US: "Welcome Steve!"
        
        context.Logger.Info(message);
    }
}
```

---

## ğŸ“– **è¯­è¨€æ–‡ä»¶**

### **æ”¯æŒçš„è¯­è¨€ä»£ç **

| è¯­è¨€ | ä»£ç  | æ–‡ä»¶å |
|------|------|--------|
| ç®€ä½“ä¸­æ–‡ | zh_CN | `zh_CN.json` |
| ç¹ä½“ä¸­æ–‡ | zh_TW | `zh_TW.json` |
| è‹±è¯­ (ç¾å›½) | en_US | `en_US.json` |
| è‹±è¯­ (è‹±å›½) | en_GB | `en_GB.json` |
| æ—¥è¯­ | ja_JP | `ja_JP.json` |
| éŸ©è¯­ | ko_KR | `ko_KR.json` |
| å¾·è¯­ | de_DE | `de_DE.json` |
| æ³•è¯­ | fr_FR | `fr_FR.json` |
| è¥¿ç­ç‰™è¯­ | es_ES | `es_ES.json` |
| ä¿„è¯­ | ru_RU | `ru_RU.json` |

### **ç¿»è¯‘é”®å‘½åè§„èŒƒ**

âœ… **æ¨èçš„å‘½åæ–¹å¼ï¼š**
```json
{
  "commands.help": "å¸®åŠ©ä¿¡æ¯",
  "commands.reload.success": "é‡è½½æˆåŠŸ",
  "commands.reload.failed": "é‡è½½å¤±è´¥",
  
  "messages.welcome": "æ¬¢è¿æ¶ˆæ¯",
  "messages.goodbye": "å‘Šåˆ«æ¶ˆæ¯",
  
  "errors.not_found": "æœªæ‰¾åˆ°",
  "errors.permission_denied": "æƒé™ä¸è¶³",
  
  "ui.button.confirm": "ç¡®è®¤",
  "ui.button.cancel": "å–æ¶ˆ"
}
```

### **å‚æ•°å ä½ç¬¦**

```json
{
  "simple": "æ¬¢è¿ {0}ï¼",
  "multiple": "ç©å®¶ {0} ç»™äº† {1} ä¸ª {2}",
  "named": "åæ ‡: X={x}, Y={y}, Z={z}"
}
```

```csharp
// ä½¿ç”¨ç´¢å¼•å ä½ç¬¦
_i18n.Translate("simple", "Steve");
// è¾“å‡º: "æ¬¢è¿ Steveï¼"

_i18n.Translate("multiple", "Steve", "10", "é’»çŸ³");
// è¾“å‡º: "ç©å®¶ Steve ç»™äº† 10 ä¸ª é’»çŸ³"
```

---

## ğŸ’» **API ä½¿ç”¨**

### **II18nService æ¥å£**

```csharp
public interface II18nService
{
    /// <summary>
    /// ç¿»è¯‘æ–‡æœ¬
    /// </summary>
    string Translate(string key, params object[] args);
    
    /// <summary>
    /// å°è¯•ç¿»è¯‘ï¼ˆä¸å­˜åœ¨åˆ™è¿”å›é”®åï¼‰
    /// </summary>
    string TryTranslate(string key, params object[] args);
    
    /// <summary>
    /// æ£€æŸ¥ç¿»è¯‘æ˜¯å¦å­˜åœ¨
    /// </summary>
    bool HasTranslation(string key);
    
    /// <summary>
    /// è·å–å½“å‰è¯­è¨€
    /// </summary>
    string CurrentLanguage { get; }
    
    /// <summary>
    /// åˆ‡æ¢è¯­è¨€
    /// </summary>
    void SetLanguage(string language);
}
```

### **åŸºæœ¬ä½¿ç”¨**

```csharp
// ç®€å•ç¿»è¯‘
var msg = _i18n.Translate("messages.welcome");

// å¸¦å‚æ•°
var msg = _i18n.Translate("messages.player_joined", playerName);

// æ£€æŸ¥æ˜¯å¦å­˜åœ¨
if (_i18n.HasTranslation("advanced.feature"))
{
    var msg = _i18n.Translate("advanced.feature");
}

// åˆ‡æ¢è¯­è¨€
_i18n.SetLanguage("en_US");
```

---

## ğŸ“ **ä½¿ç”¨ç¤ºä¾‹**

### **1. å¤šè¯­è¨€å‘½ä»¤**

```csharp
public class WelcomeCommand : ICommand
{
    private readonly II18nService _i18n;
    private readonly IGameDisplayApi _gameDisplay;
    
    public async Task<CommandResult> ExecuteAsync(ICommandSender sender, string[] args)
    {
        var playerName = args.Length > 0 ? args[0] : sender.Name;
        
        // è‡ªåŠ¨æ ¹æ®é…ç½®çš„è¯­è¨€ç¿»è¯‘
        var message = _i18n.Translate("commands.welcome.message", playerName);
        var tip = _i18n.Translate("commands.welcome.tip");
        
        await _gameDisplay.SendChatMessageAsync(
            sender.Name,
            $"{message}\n{tip}"
        );
        
        return CommandResult.Ok(_i18n.Translate("commands.welcome.sent"));
    }
}
```

**è¯­è¨€æ–‡ä»¶ï¼š**
```json
{
  "commands.welcome.message": "Â§aæ¬¢è¿ {0} åŠ å…¥æœåŠ¡å™¨ï¼",
  "commands.welcome.tip": "Â§7è¾“å…¥ #help æŸ¥çœ‹å¸®åŠ©",
  "commands.welcome.sent": "æ¬¢è¿æ¶ˆæ¯å·²å‘é€"
}
```

### **2. åŠ¨æ€è¯­è¨€åˆ‡æ¢**

```csharp
public class LanguageCommand : ICommand
{
    private readonly II18nService _i18n;
    
    public async Task<CommandResult> ExecuteAsync(ICommandSender sender, string[] args)
    {
        if (args.Length == 0)
        {
            var current = _i18n.CurrentLanguage;
            return CommandResult.Ok($"å½“å‰è¯­è¨€: {current}");
        }
        
        var newLang = args[0];
        _i18n.SetLanguage(newLang);
        
        // åˆ‡æ¢åçš„æ¶ˆæ¯ä¼šç”¨æ–°è¯­è¨€æ˜¾ç¤º
        var message = _i18n.Translate("commands.language.changed", newLang);
        return CommandResult.Ok(message);
    }
}
```

### **3. å¤šè¯­è¨€å¸®åŠ©ç³»ç»Ÿ**

```csharp
public class HelpCommand : ICommand
{
    private readonly II18nService _i18n;
    
    public async Task<CommandResult> ExecuteAsync(ICommandSender sender, string[] args)
    {
        var help = new StringBuilder();
        help.AppendLine(_i18n.Translate("help.title"));
        help.AppendLine();
        
        // å‘½ä»¤åˆ—è¡¨
        help.AppendLine(_i18n.Translate("help.commands"));
        help.AppendLine($"  #spawn - {_i18n.Translate("help.spawn")}");
        help.AppendLine($"  #home - {_i18n.Translate("help.home")}");
        help.AppendLine($"  #tpa - {_i18n.Translate("help.tpa")}");
        
        sender.SendMessage(help.ToString());
        return CommandResult.Ok();
    }
}
```

**zh_CN.json:**
```json
{
  "help.title": "Â§6=== å‘½ä»¤å¸®åŠ© ===",
  "help.commands": "Â§eå¯ç”¨å‘½ä»¤:",
  "help.spawn": "ä¼ é€åˆ°å‡ºç”Ÿç‚¹",
  "help.home": "ä¼ é€åˆ°å®¶",
  "help.tpa": "è¯·æ±‚ä¼ é€åˆ°ç©å®¶"
}
```

**en_US.json:**
```json
{
  "help.title": "Â§6=== Command Help ===",
  "help.commands": "Â§eAvailable Commands:",
  "help.spawn": "Teleport to spawn",
  "help.home": "Teleport to home",
  "help.tpa": "Request teleport to player"
}
```

### **4. é”™è¯¯æ¶ˆæ¯å›½é™…åŒ–**

```csharp
public class TeleportCommand : ICommand
{
    private readonly II18nService _i18n;
    private readonly ISmpApi _smpApi;
    
    public async Task<CommandResult> ExecuteAsync(ICommandSender sender, string[] args)
    {
        if (args.Length == 0)
        {
            return CommandResult.Fail(_i18n.Translate("errors.missing_player"));
        }
        
        var targetPlayer = args[0];
        var players = await _smpApi.GetPlayersAsync();
        
        if (!players.Any(p => p.Name == targetPlayer))
        {
            return CommandResult.Fail(
                _i18n.Translate("errors.player_not_found", targetPlayer)
            );
        }
        
        // æ‰§è¡Œä¼ é€...
        return CommandResult.Ok(
            _i18n.Translate("commands.teleport.success", targetPlayer)
        );
    }
}
```

---

## ğŸ”§ **é«˜çº§åŠŸèƒ½**

### **1. å›é€€æœºåˆ¶**

å¦‚æœå½“å‰è¯­è¨€ç¼ºå°‘æŸä¸ªé”®ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å›é€€åˆ°é»˜è®¤è¯­è¨€ï¼ˆé€šå¸¸æ˜¯ `en_US`ï¼‰ï¼š

```csharp
// å½“å‰è¯­è¨€: ja_JP
// ja_JP.json ä¸­æ²¡æœ‰ "advanced.feature" é”®
// ç³»ç»Ÿä¼šè‡ªåŠ¨ä½¿ç”¨ en_US.json ä¸­çš„å€¼
var msg = _i18n.Translate("advanced.feature");
```

### **2. åµŒå¥—é”®**

```json
{
  "game": {
    "modes": {
      "survival": "ç”Ÿå­˜æ¨¡å¼",
      "creative": "åˆ›é€ æ¨¡å¼",
      "adventure": "å†’é™©æ¨¡å¼"
    }
  }
}
```

```csharp
var mode = _i18n.Translate("game.modes.survival");
```

### **3. å¤æ•°å½¢å¼å¤„ç†**

```json
{
  "items.count.zero": "æ²¡æœ‰ç‰©å“",
  "items.count.one": "1 ä¸ªç‰©å“",
  "items.count.other": "{0} ä¸ªç‰©å“"
}
```

```csharp
public string GetItemCountMessage(int count)
{
    var key = count == 0 ? "items.count.zero" :
              count == 1 ? "items.count.one" :
                          "items.count.other";
    
    return _i18n.Translate(key, count);
}
```

---

## ğŸ’¡ **æœ€ä½³å®è·µ**

### **1. ç»Ÿä¸€çš„é”®å‘½å**

âœ… **æ¨èï¼š** ä½¿ç”¨å±‚çº§ç»“æ„
```json
{
  "plugin.myfeature.title": "æ ‡é¢˜",
  "plugin.myfeature.description": "æè¿°",
  "plugin.myfeature.button.confirm": "ç¡®è®¤",
  "plugin.myfeature.button.cancel": "å–æ¶ˆ"
}
```

### **2. å®Œæ•´çš„è¯­è¨€è¦†ç›–**

âœ… **æ¨èï¼š** ç¡®ä¿æ‰€æœ‰è¯­è¨€æ–‡ä»¶éƒ½æœ‰ç›¸åŒçš„é”®
```bash
# ä½¿ç”¨å·¥å…·æ£€æŸ¥ç¼ºå¤±çš„é”®
diff zh_CN.json en_US.json
```

### **3. å‚æ•°åŒ–æ¶ˆæ¯**

âœ… **æ¨èï¼š** ä½¿ç”¨å‚æ•°è€Œä¸æ˜¯å­—ç¬¦ä¸²æ‹¼æ¥
```json
{
  "good": "ç©å®¶ {0} è·å¾—äº† {1} ä¸ª {2}",
  "bad": "ç©å®¶è·å¾—äº†ç‰©å“"
}
```

### **4. ä¿æŒç¿»è¯‘æ–‡ä»¶æ•´æ´**

âœ… **æ¨èï¼š** æ·»åŠ æ³¨é‡Šï¼ˆå¦‚æœæ ¼å¼æ”¯æŒï¼‰
```json
{
  "_comment": "å‘½ä»¤ç›¸å…³ç¿»è¯‘",
  "commands.help": "å¸®åŠ©",
  "commands.reload": "é‡è½½",
  
  "_comment": "é”™è¯¯æ¶ˆæ¯",
  "errors.not_found": "æœªæ‰¾åˆ°",
  "errors.permission_denied": "æƒé™ä¸è¶³"
}
```

---

## ğŸ“š **ç›¸å…³æ–‡æ¡£**

- [å‘½ä»¤ç³»ç»Ÿ](../02-æ ¸å¿ƒåŠŸèƒ½/å‘½ä»¤ç³»ç»Ÿ.md)
- [æ’ä»¶å¼€å‘æŒ‡å—](../03-æ’ä»¶å¼€å‘/æ’ä»¶å¼€å‘æŒ‡å—.md)

---

## ğŸ™ **è‡´è°¢**

å›½é™…åŒ–ç³»ç»Ÿçš„è®¾è®¡å— [MCDReforged](https://github.com/Fallen-Breath/MCDReforged) å¯å‘ã€‚

---

**æ–‡æ¡£ç»´æŠ¤è€…ï¼š** NetherGate å¼€å‘å›¢é˜Ÿ  
**æœ€åæ›´æ–°ï¼š** 2025-01-08  
**å‚è€ƒé¡¹ç›®ï¼š** [MCDReforged](https://github.com/Fallen-Breath/MCDReforged) (GPL-3.0)

