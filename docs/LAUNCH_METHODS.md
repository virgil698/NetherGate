# æœåŠ¡å™¨å¯åŠ¨æ–¹å¼é…ç½®

NetherGate æä¾›ä¸¤ç§æœåŠ¡å™¨å¯åŠ¨æ–¹å¼ï¼Œæ‚¨å¯ä»¥æ ¹æ®éœ€æ±‚é€‰æ‹©ï¼š

---

## ğŸ“‹ å¯åŠ¨æ–¹å¼å¯¹æ¯”

| ç‰¹æ€§ | Java å¯åŠ¨ | Script å¯åŠ¨ |
|------|-----------|-------------|
| **é…ç½®æ–¹å¼** | åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½® JVM å‚æ•° | ä½¿ç”¨ç°æœ‰çš„å¯åŠ¨è„šæœ¬ |
| **çµæ´»æ€§** | æ ‡å‡†åŒ–ï¼ŒNetherGate è‡ªåŠ¨æ„å»ºå‘½ä»¤ | é«˜åº¦çµæ´»ï¼Œå®Œå…¨è‡ªå®šä¹‰ |
| **é€‚ç”¨åœºæ™¯** | ç®€å•éƒ¨ç½²ï¼Œæ ‡å‡† Minecraft æœåŠ¡å™¨ | å¤æ‚è„šæœ¬ï¼Œè‡ªå®šä¹‰å¯åŠ¨é€»è¾‘ |
| **è„šæœ¬æ”¯æŒ** | ä¸éœ€è¦è„šæœ¬ | æ”¯æŒ .bat, .sh, .cmd, .exe |
| **æ¨èç”¨æˆ·** | æ–°æ‰‹ï¼Œæ ‡å‡†éƒ¨ç½² | é«˜çº§ç”¨æˆ·ï¼Œå·²æœ‰å¯åŠ¨è„šæœ¬ |

---

## ğŸ¯ æ–¹å¼ 1ï¼šJava å¯åŠ¨ï¼ˆæ¨èï¼‰

NetherGate è‡ªåŠ¨æ„å»º Java å¯åŠ¨å‘½ä»¤ï¼Œé€‚åˆå¤§å¤šæ•°åœºæ™¯ã€‚

### é…ç½®ç¤ºä¾‹

```json
{
    "server_process": {
        "enabled": true,
        "launch_method": "java",
        "java": {
            "path": "java",
            "version_check": true
        },
        "server": {
            "jar": "server.jar",
            "working_directory": "./minecraft_server"
        },
        "memory": {
            "min": 2048,
            "max": 4096
        },
        "arguments": {
            "jvm_prefix": [],
            "jvm_middle": [
                "-XX:+UseG1GC",
                "-XX:MaxGCPauseMillis=200",
                "-Dfile.encoding=UTF-8"
            ],
            "server": [
                "--nogui"
            ]
        }
    }
}
```

### ç”Ÿæˆçš„å‘½ä»¤ç¤ºä¾‹

```bash
java -Xms2048M -Xmx4096M -XX:+UseG1GC -XX:MaxGCPauseMillis=200 -Dfile.encoding=UTF-8 -jar server.jar --nogui
```

### ä¼˜ç‚¹

- âœ… é…ç½®ç®€å•ï¼Œç›´è§‚æ˜“æ‡‚
- âœ… NetherGate è‡ªåŠ¨å¤„ç†å‘½ä»¤æ„å»º
- âœ… è·¨å¹³å°ä¸€è‡´æ€§
- âœ… æ˜“äºè°ƒæ•´ JVM å‚æ•°

### é€‚ç”¨åœºæ™¯

- æ ‡å‡† Minecraft æœåŠ¡å™¨éƒ¨ç½²
- ä¸éœ€è¦å¤æ‚å¯åŠ¨é€»è¾‘
- å¸Œæœ›é…ç½®æ–‡ä»¶ç®¡ç†æ‰€æœ‰å‚æ•°
- æ–°æ‰‹æˆ–ç®€å•éƒ¨ç½²

---

## ğŸ”§ æ–¹å¼ 2ï¼šScript å¯åŠ¨ï¼ˆé«˜çº§ï¼‰

ä½¿ç”¨æ‚¨ç°æœ‰çš„å¯åŠ¨è„šæœ¬ï¼ŒNetherGate åªè´Ÿè´£æ‰§è¡Œå’Œç›‘æ§ã€‚

### é…ç½®ç¤ºä¾‹

```json
{
    "server_process": {
        "enabled": true,
        "launch_method": "script",
        "script": {
            "path": "./start.sh",
            "arguments": [],
            "working_directory": "./minecraft_server",
            "use_shell": false
        }
    }
}
```

### è„šæœ¬ç¤ºä¾‹

**Windows (start.bat)**:
```batch
@echo off
java -Xms4G -Xmx8G -XX:+UseZGC -jar server.jar nogui
```

**Linux/macOS (start.sh)**:
```bash
#!/bin/bash
java -Xms4G -Xmx8G -XX:+UseZGC -jar server.jar nogui
```

### é…ç½®è¯´æ˜

#### `path` - è„šæœ¬è·¯å¾„
- æ”¯æŒçš„æ ¼å¼ï¼š`.bat`, `.sh`, `.cmd`, `.exe`
- å¯ä»¥æ˜¯ç›¸å¯¹è·¯å¾„æˆ–ç»å¯¹è·¯å¾„
- ç›¸å¯¹è·¯å¾„åŸºäº `working_directory`

ç¤ºä¾‹ï¼š
```json
"path": "./start.sh"           // Linux/macOS
"path": "./start.bat"          // Windows
"path": "/path/to/start.sh"    // ç»å¯¹è·¯å¾„
"path": "./launcher.exe"       // å¯æ‰§è¡Œæ–‡ä»¶
```

#### `arguments` - è„šæœ¬å‚æ•°
ä¼ é€’ç»™è„šæœ¬çš„å‚æ•°åˆ—è¡¨ã€‚

ç¤ºä¾‹ï¼š
```json
"arguments": ["--config", "custom.yml", "--verbose"]
```

ç›¸å½“äºæ‰§è¡Œï¼š
```bash
./start.sh --config custom.yml --verbose
```

#### `working_directory` - å·¥ä½œç›®å½•
è„šæœ¬æ‰§è¡Œçš„ç›®å½•ã€‚

#### `use_shell` - ä½¿ç”¨ Shell æ‰§è¡Œï¼ˆLinux/macOSï¼‰
- `false`ï¼ˆé»˜è®¤ï¼‰: ç›´æ¥æ‰§è¡Œè„šæœ¬æ–‡ä»¶
- `true`: ä½¿ç”¨ `sh -c` æ‰§è¡Œ

**ä½•æ—¶å¯ç”¨**ï¼š
- è„šæœ¬åŒ…å« shell ç‰¹æ€§ï¼ˆç®¡é“ã€é‡å®šå‘ç­‰ï¼‰
- éœ€è¦æ‰§è¡Œå¤æ‚çš„ shell å‘½ä»¤

### ä¼˜ç‚¹

- âœ… å®Œå…¨æ§åˆ¶å¯åŠ¨æµç¨‹
- âœ… å¯ä»¥ä½¿ç”¨ç°æœ‰çš„å¯åŠ¨è„šæœ¬
- âœ… æ”¯æŒå¤æ‚çš„å¯åŠ¨é€»è¾‘
- âœ… å…¼å®¹å„ç§å¯åŠ¨å™¨å’Œå·¥å…·

### é€‚ç”¨åœºæ™¯

- å·²æœ‰æˆç†Ÿçš„å¯åŠ¨è„šæœ¬
- éœ€è¦å¤æ‚çš„å¯åŠ¨å‰/åå¤„ç†
- ä½¿ç”¨ç¬¬ä¸‰æ–¹å¯åŠ¨å™¨ï¼ˆå¦‚ Forge, Fabricï¼‰
- éœ€è¦ç¯å¢ƒå˜é‡è®¾ç½®æˆ–æ¡ä»¶åˆ¤æ–­

---

## ğŸ”„ åˆ‡æ¢å¯åŠ¨æ–¹å¼

åªéœ€ä¿®æ”¹ `launch_method` å­—æ®µï¼š

### ä» Script åˆ‡æ¢åˆ° Java

```json
{
    "server_process": {
        "launch_method": "java",  // æ”¹ä¸º "java"
        // ç¡®ä¿ java, server, memory, arguments é…ç½®æ­£ç¡®
    }
}
```

### ä» Java åˆ‡æ¢åˆ° Script

```json
{
    "server_process": {
        "launch_method": "script",  // æ”¹ä¸º "script"
        // ç¡®ä¿ script é…ç½®æ­£ç¡®
    }
}
```

---

## ğŸ’¡ æœ€ä½³å®è·µ

### Java å¯åŠ¨æ–¹å¼

1. **å†…å­˜é…ç½®**
   - æ ¹æ®æœåŠ¡å™¨è§„æ¨¡è°ƒæ•´ `min` å’Œ `max`
   - æ¨è `min` = `max` ä»¥é¿å…å†…å­˜æŠ–åŠ¨

2. **JVM å‚æ•°**
   - `jvm_prefix`: å¾ˆå°‘ä½¿ç”¨ï¼Œç•™ç©ºå³å¯
   - `jvm_middle`: ä¸»è¦çš„ JVM ä¼˜åŒ–å‚æ•°
   - `server`: Minecraft æœåŠ¡å™¨å‚æ•°ï¼ˆå¦‚ `--nogui`ï¼‰

3. **æ¨èå‚æ•°ç»„åˆ**
   - **å°å‹æœåŠ¡å™¨** (< 10 äºº): ä½¿ç”¨é»˜è®¤ G1GC å‚æ•°
   - **ä¸­å‹æœåŠ¡å™¨** (10-50 äºº): Aikar's flagsï¼ˆç¤ºä¾‹é…ç½®ä¸­å·²åŒ…å«ï¼‰
   - **å¤§å‹æœåŠ¡å™¨** (50+ äºº): è€ƒè™‘ä½¿ç”¨ ZGCï¼ˆJava 15+ï¼‰

### Script å¯åŠ¨æ–¹å¼

1. **è„šæœ¬æƒé™**
   - Linux/macOS ç¡®ä¿è„šæœ¬æœ‰æ‰§è¡Œæƒé™ï¼š`chmod +x start.sh`
   - Windows ç¡®ä¿è„šæœ¬è·¯å¾„æ­£ç¡®

2. **è·¯å¾„å¤„ç†**
   - ä½¿ç”¨ç›¸å¯¹è·¯å¾„æ—¶ï¼ŒåŸºäº `working_directory`
   - æ¨èä½¿ç”¨ç»å¯¹è·¯å¾„é¿å…æ··æ·†

3. **æ—¥å¿—è¾“å‡º**
   - è„šæœ¬åº”è¯¥è¾“å‡ºåˆ° stdout/stderr
   - NetherGate ä¼šè‡ªåŠ¨æ•è·å’Œç›‘æ§

4. **é€€å‡ºå¤„ç†**
   - è„šæœ¬åº”è¯¥æ­£ç¡®ä¼ é€’æœåŠ¡å™¨çš„é€€å‡ºä»£ç 
   - é¿å…è„šæœ¬ä¸­ä½¿ç”¨æ— é™å¾ªç¯

---

## âš™ï¸ è¿›ç¨‹ç›‘æ§

æ— è®ºä½¿ç”¨å“ªç§å¯åŠ¨æ–¹å¼ï¼ŒNetherGate éƒ½ä¼šç›‘æ§æœåŠ¡å™¨è¿›ç¨‹ï¼š

### å¯åŠ¨æ£€æµ‹
```json
"startup_detection": {
    "enabled": true,
    "keywords": ["Done (", "For help, type \"help\""]
}
```

### å´©æºƒæ£€æµ‹
```json
"crash_detection": {
    "enabled": true,
    "keywords": [
        "Exception in server tick loop",
        "A fatal error has been detected",
        "OutOfMemoryError"
    ]
}
```

### è‡ªåŠ¨é‡å¯
```json
"auto_restart": {
    "enabled": true,
    "max_retries": 3,
    "retry_delay": 5000,
    "reset_timer": 600000
}
```

è¿™äº›ç›‘æ§é…ç½®å¯¹ä¸¤ç§å¯åŠ¨æ–¹å¼éƒ½æœ‰æ•ˆã€‚

---

## ğŸ¯ é€‰æ‹©å»ºè®®

### é€‰æ‹© Java å¯åŠ¨ï¼Œå¦‚æœæ‚¨ï¼š
- âœ… æ˜¯æ–°æ‰‹ï¼Œåˆšå¼€å§‹ä½¿ç”¨ NetherGate
- âœ… è¿è¡Œæ ‡å‡†çš„ Minecraft æœåŠ¡å™¨
- âœ… å¸Œæœ›é€šè¿‡é…ç½®æ–‡ä»¶ç®¡ç†æ‰€æœ‰å‚æ•°
- âœ… éœ€è¦è·¨å¹³å°ä¸€è‡´æ€§

### é€‰æ‹© Script å¯åŠ¨ï¼Œå¦‚æœæ‚¨ï¼š
- âœ… å·²ç»æœ‰æˆç†Ÿçš„å¯åŠ¨è„šæœ¬
- âœ… éœ€è¦å¤æ‚çš„å¯åŠ¨å‰/åå¤„ç†
- âœ… ä½¿ç”¨ç¬¬ä¸‰æ–¹å¯åŠ¨å™¨ï¼ˆForge, Fabric ç­‰ï¼‰
- âœ… éœ€è¦é«˜åº¦è‡ªå®šä¹‰çš„å¯åŠ¨æµç¨‹

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [é…ç½®æ–‡ä»¶è¯¦è§£](CONFIGURATION.md)
- [æœåŠ¡å™¨è¿›ç¨‹ç®¡ç†](SERVER_PROCESS.md)
- [é…ç½®ç¤ºä¾‹](config.example.json)

---

**æœ€åæ›´æ–°**: 2025-10-04

