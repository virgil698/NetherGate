# NetherGate é…ç½®æ–‡ä»¶è¯¦è§£

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜ NetherGate çš„æ‰€æœ‰é…ç½®é€‰é¡¹ï¼ŒåŸºäºå®é™…é…ç½®ç±»ç»“æ„ã€‚

---

## ğŸ“‹ ç›®å½•

- [é…ç½®æ–‡ä»¶ä½ç½®](#é…ç½®æ–‡ä»¶ä½ç½®)
- [æœåŠ¡å™¨è¿›ç¨‹ç®¡ç†](#æœåŠ¡å™¨è¿›ç¨‹ç®¡ç†-server_process)
- [SMP è¿æ¥é…ç½®](#smp-è¿æ¥é…ç½®-server_connection)
- [RCON å®¢æˆ·ç«¯é…ç½®](#rcon-å®¢æˆ·ç«¯é…ç½®-rcon)
- [æ—¥å¿—ç›‘å¬å™¨é…ç½®](#æ—¥å¿—ç›‘å¬å™¨é…ç½®-log_listener)
- [æ’ä»¶ç®¡ç†é…ç½®](#æ’ä»¶ç®¡ç†é…ç½®-plugins)
- [æ—¥å¿—ç³»ç»Ÿé…ç½®](#æ—¥å¿—ç³»ç»Ÿé…ç½®-logging)
- [spark æ€§èƒ½ç›‘æ§é…ç½®](#spark-æ€§èƒ½ç›‘æ§é…ç½®-spark)
- [é«˜çº§é…ç½®](#é«˜çº§é…ç½®-advanced)
- [WebSocket æœåŠ¡å™¨é…ç½®](#websocket-æœåŠ¡å™¨é…ç½®)
- [å®Œæ•´é…ç½®ç¤ºä¾‹](#å®Œæ•´é…ç½®ç¤ºä¾‹)

---

## ğŸ“ é…ç½®æ–‡ä»¶ä½ç½®

NetherGate é…ç½®æ–‡ä»¶ä½äºç¨‹åºæ ¹ç›®å½•ï¼Œ**æ”¯æŒ JSON å’Œ YAML ä¸¤ç§æ ¼å¼**ã€‚

```
NetherGate/
â”œâ”€â”€ nethergate-config.yaml  # ä¸»é…ç½®æ–‡ä»¶ï¼ˆYAML æ ¼å¼ï¼Œæ¨èï¼‰
â”œâ”€â”€ nethergate-config.yml   # æˆ–ä½¿ç”¨ .yml æ‰©å±•å
â””â”€â”€ nethergate-config.json  # æˆ–ä½¿ç”¨ JSON æ ¼å¼
```

### **é…ç½®æ–‡ä»¶ä¼˜å…ˆçº§**

1. `nethergate-config.yaml` (ä¼˜å…ˆçº§æœ€é«˜)
2. `nethergate-config.yml`
3. `nethergate-config.json`

### **é¦–æ¬¡å¯åŠ¨æµç¨‹**

1. NetherGate æ£€æµ‹åˆ°é…ç½®æ–‡ä»¶ä¸å­˜åœ¨
2. è‡ªåŠ¨ç”Ÿæˆ `nethergate-config.yaml`ï¼ˆé»˜è®¤YAMLæ ¼å¼ï¼‰
3. æ˜¾ç¤ºé…ç½®æ–‡ä»¶ä½ç½®å’Œé‡è¦é…ç½®é¡¹æç¤º
4. ç»§ç»­å¯åŠ¨ï¼ˆä½¿ç”¨é»˜è®¤é…ç½®ï¼‰

### **æ ¼å¼é€‰æ‹©å»ºè®®**

- **YAML** - âœ… æ¨èä½¿ç”¨ï¼Œæ”¯æŒæ³¨é‡Šï¼Œå¯è¯»æ€§å¼º
- **JSON** - âš ï¸ å…¼å®¹æ€§å¥½ï¼Œä½†ä¸æ”¯æŒæ³¨é‡Š

> ğŸ’¡ **æç¤º**ï¼šå¯ä»¥åŒæ—¶å­˜åœ¨å¤šä¸ªæ ¼å¼ï¼Œç³»ç»Ÿä¼šæŒ‰ä¼˜å…ˆçº§åŠ è½½ç¬¬ä¸€ä¸ªæ‰¾åˆ°çš„æ–‡ä»¶

---

## ğŸ–¥ï¸ æœåŠ¡å™¨è¿›ç¨‹ç®¡ç† (server_process)

NetherGate å¯ä»¥è‡ªåŠ¨å¯åŠ¨å’Œç®¡ç† Minecraft æœåŠ¡å™¨è¿›ç¨‹ã€‚

### **åŸºç¡€é…ç½®**

```yaml
server_process:
  # æ˜¯å¦å¯ç”¨è¿›ç¨‹ç®¡ç†
  enabled: true
  
  # å¯åŠ¨æ–¹å¼ï¼šjava | script | external
  launch_method: java
  
  # Java é…ç½®ï¼ˆlaunch_method = java æ—¶ä½¿ç”¨ï¼‰
  java:
    path: java              # Java å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„
    version_check: true     # å¯åŠ¨å‰æ£€æŸ¥ Java ç‰ˆæœ¬
  
  # æœåŠ¡å™¨ JAR é…ç½®ï¼ˆlaunch_method = java æ—¶ä½¿ç”¨ï¼‰
  server:
    jar: server.jar         # æœåŠ¡å™¨ JAR æ–‡ä»¶å
    working_directory: ./minecraft_server  # æœåŠ¡å™¨å·¥ä½œç›®å½•
  
  # å†…å­˜é…ç½®ï¼ˆlaunch_method = java æ—¶ä½¿ç”¨ï¼‰
  memory:
    min: 2048               # æœ€å°å†…å­˜ï¼ˆMBï¼‰
    max: 4096               # æœ€å¤§å†…å­˜ï¼ˆMBï¼‰
  
  # JVM å‚æ•°é…ç½®ï¼ˆlaunch_method = java æ—¶ä½¿ç”¨ï¼‰
  arguments:
    jvm_prefix: []          # JVM å‰ç½®å‚æ•°
    jvm_middle:             # JVM ä¸­é—´å‚æ•°
      - -XX:+UseG1GC
      - -Dfile.encoding=UTF-8
    server:                 # æœåŠ¡å™¨å‚æ•°
      - --nogui
  
  # è„šæœ¬é…ç½®ï¼ˆlaunch_method = script æ—¶ä½¿ç”¨ï¼‰
  script:
    path: ./start.sh        # è„šæœ¬è·¯å¾„
    arguments: []           # è„šæœ¬å‚æ•°
    working_directory: ./minecraft_server
    use_shell: false        # æ˜¯å¦ä½¿ç”¨ Shell æ‰§è¡Œï¼ˆLinux/macOSï¼‰
  
  # è¿›ç¨‹ç›‘æ§é…ç½®
  monitoring:
    startup_timeout: 300    # å¯åŠ¨è¶…æ—¶ï¼ˆç§’ï¼‰
    show_server_output: true  # æ˜¾ç¤ºæœåŠ¡å™¨è¾“å‡º
    server_output_prefix: "[MC] "  # æœåŠ¡å™¨è¾“å‡ºå‰ç¼€
    
    startup_detection:      # å¯åŠ¨æ£€æµ‹
      enabled: true
      keywords:
        - "Done ("          # å¯åŠ¨å®Œæˆå…³é”®è¯
    
    crash_detection:        # å´©æºƒæ£€æµ‹
      enabled: true
      keywords:
        - "Exception in server tick loop"
  
  # è‡ªåŠ¨é‡å¯é…ç½®
  auto_restart:
    enabled: true           # æ˜¯å¦å¯ç”¨è‡ªåŠ¨é‡å¯
    delay_seconds: 5        # é‡å¯å»¶è¿Ÿï¼ˆç§’ï¼‰
    max_retries: 3          # æœ€å¤§é‡è¯•æ¬¡æ•°
    retry_delay: 5000       # é‡è¯•å»¶è¿Ÿï¼ˆæ¯«ç§’ï¼‰
    reset_timer: 600000     # é‡è¯•è®¡æ•°å™¨é‡ç½®æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
```

### **é…ç½®é¡¹è¯´æ˜**

| é…ç½®é¡¹ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|--------|------|
| `enabled` | boolean | `true` | æ˜¯å¦å¯ç”¨è¿›ç¨‹ç®¡ç† |
| `launch_method` | string | `"java"` | å¯åŠ¨æ–¹å¼ï¼š`java`/`script`/`external` |

### **å¯åŠ¨æ–¹å¼è¯¦è§£**

#### **1. java æ¨¡å¼ï¼ˆæ¨èï¼‰**

NetherGate ç›´æ¥æ„å»º Java å‘½ä»¤å¯åŠ¨æœåŠ¡å™¨ã€‚

**å®Œæ•´å‘½ä»¤æ ¼å¼ï¼š**
```bash
java [jvm_prefix] -Xms<min>M -Xmx<max>M [jvm_middle] -jar <jar> [server]
```

**ç¤ºä¾‹ï¼š**
```bash
java -Xms2048M -Xmx4096M -XX:+UseG1GC -Dfile.encoding=UTF-8 -jar server.jar --nogui
```

#### **2. script æ¨¡å¼**

é€šè¿‡è„šæœ¬å¯åŠ¨æœåŠ¡å™¨ï¼ˆé€‚åˆè‡ªå®šä¹‰å¯åŠ¨é€»è¾‘ï¼‰ã€‚

**Linux/macOS è„šæœ¬ç¤ºä¾‹ (`start.sh`)ï¼š**
```bash
#!/bin/bash
cd /opt/minecraft/server
java -Xmx4G -Xms2G -jar server.jar nogui
```

**Windows è„šæœ¬ç¤ºä¾‹ (`start.bat`)ï¼š**
```batch
@echo off
cd C:\Minecraft\Server
java -Xmx4G -Xms2G -jar server.jar nogui
```

#### **3. external æ¨¡å¼**

æœåŠ¡å™¨å·²åœ¨å¤–éƒ¨è¿è¡Œï¼ŒNetherGate ä»…è¿æ¥ç®¡ç†ã€‚

**é…ç½®è¦ç‚¹ï¼š**
- ä»éœ€æŒ‡å®š `server.working_directory` ç”¨äºæ–‡ä»¶è®¿é—®
- ç¡®ä¿ RCON å’Œ SMP é…ç½®æ­£ç¡®
- NetherGate ä¸ä¼šå¯åŠ¨/åœæ­¢æœåŠ¡å™¨è¿›ç¨‹

---

### **å¯åŠ¨æ–¹å¼å¯¹æ¯”**

| ç‰¹æ€§ | java | script | external |
|------|------|--------|----------|
| **è¿›ç¨‹ç®¡ç†** | âœ… å®Œå…¨ç®¡ç† | âœ… å®Œå…¨ç®¡ç† | âŒ ä»…è¿æ¥ |
| **å´©æºƒæ£€æµ‹** | âœ… æ”¯æŒ | âœ… æ”¯æŒ | âš ï¸ æœ‰é™æ”¯æŒ |
| **è‡ªåŠ¨é‡å¯** | âœ… æ”¯æŒ | âœ… æ”¯æŒ | âŒ ä¸æ”¯æŒ |
| **å¯åŠ¨æµç¨‹æ§åˆ¶** | âœ… ç²¾ç¡®æ§åˆ¶ | âš ï¸ ä¾èµ–è„šæœ¬ | âŒ æ— æ§åˆ¶ |
| **é…ç½®æ–¹å¼** | YAML é…ç½® | è„šæœ¬æ–‡ä»¶ | å¤–éƒ¨ç®¡ç† |
| **çµæ´»æ€§** | â­â­â­ | â­â­â­â­â­ | â­â­ |
| **æ˜“ç”¨æ€§** | â­â­â­â­â­ | â­â­â­ | â­â­â­ |
| **é€‚åˆæ–°æ‰‹** | âœ… æ˜¯ | âŒ å¦ | âŒ å¦ |

### **è„šæœ¬æ¨¡å¼è¯¦ç»†ç¤ºä¾‹**

#### **åŸºç¡€è„šæœ¬**

**Linux/macOS (`start.sh`):**
```bash
#!/bin/bash
# è®¾ç½®å·¥ä½œç›®å½•
cd /opt/minecraft/server

# å¯åŠ¨æœåŠ¡å™¨
java -Xms2G -Xmx4G \
  -XX:+UseG1GC \
  -XX:+ParallelRefProcEnabled \
  -XX:MaxGCPauseMillis=200 \
  -Dfile.encoding=UTF-8 \
  -jar server.jar nogui
```

**Windows (`start.bat`):**
```batch
@echo off
:: è®¾ç½®å·¥ä½œç›®å½•
cd C:\Minecraft\Server

:: å¯åŠ¨æœåŠ¡å™¨
java -Xms2G -Xmx4G ^
  -XX:+UseG1GC ^
  -XX:+ParallelRefProcEnabled ^
  -XX:MaxGCPauseMillis=200 ^
  -Dfile.encoding=UTF-8 ^
  -jar server.jar nogui
```

#### **é«˜çº§è„šæœ¬ï¼ˆå¸¦ç¯å¢ƒæ£€æµ‹ï¼‰**

**Linux/macOS (`start.sh`):**
```bash
#!/bin/bash
set -e  # é‡åˆ°é”™è¯¯ç«‹å³é€€å‡º

# åˆ‡æ¢åˆ°è„šæœ¬æ‰€åœ¨ç›®å½•
cd "$(dirname "$0")"

# æ£€æŸ¥ Java æ˜¯å¦å®‰è£…
if ! command -v java &> /dev/null; then
    echo "é”™è¯¯: æœªæ‰¾åˆ° Javaï¼Œè¯·å…ˆå®‰è£… Java 17+"
    exit 1
fi

# æ£€æŸ¥ Java ç‰ˆæœ¬
JAVA_VERSION=$(java -version 2>&1 | awk -F '"' '/version/ {print $2}' | cut -d. -f1)
if [ "$JAVA_VERSION" -lt 17 ]; then
    echo "é”™è¯¯: Java ç‰ˆæœ¬è¿‡ä½ï¼ˆéœ€è¦ 17+ï¼‰ï¼Œå½“å‰ç‰ˆæœ¬: $JAVA_VERSION"
    exit 1
fi

# æ£€æŸ¥æœåŠ¡å™¨ JAR æ˜¯å¦å­˜åœ¨
if [ ! -f "server.jar" ]; then
    echo "é”™è¯¯: æœªæ‰¾åˆ° server.jar"
    exit 1
fi

# æ¥å— EULAï¼ˆé¦–æ¬¡è¿è¡Œï¼‰
if [ ! -f "eula.txt" ]; then
    echo "eula=true" > eula.txt
    echo "å·²è‡ªåŠ¨æ¥å— Minecraft EULA"
fi

# å¯åŠ¨æœåŠ¡å™¨
echo "æ­£åœ¨å¯åŠ¨ Minecraft æœåŠ¡å™¨..."
java -Xms2G -Xmx4G \
  -XX:+UseG1GC \
  -XX:+ParallelRefProcEnabled \
  -XX:MaxGCPauseMillis=200 \
  -XX:+UnlockExperimentalVMOptions \
  -XX:+DisableExplicitGC \
  -XX:+AlwaysPreTouch \
  -XX:G1NewSizePercent=30 \
  -XX:G1MaxNewSizePercent=40 \
  -XX:G1HeapRegionSize=8M \
  -Dfile.encoding=UTF-8 \
  -Duser.language=zh \
  -Duser.country=CN \
  -jar server.jar nogui
```

**Windows (`start.bat`):**
```batch
@echo off
setlocal enabledelayedexpansion

:: åˆ‡æ¢åˆ°è„šæœ¬æ‰€åœ¨ç›®å½•
cd /d "%~dp0"

:: æ£€æŸ¥ Java æ˜¯å¦å®‰è£…
where java >nul 2>&1
if errorlevel 1 (
    echo é”™è¯¯: æœªæ‰¾åˆ° Javaï¼Œè¯·å…ˆå®‰è£… Java 17+
    exit /b 1
)

:: æ£€æŸ¥æœåŠ¡å™¨ JAR æ˜¯å¦å­˜åœ¨
if not exist "server.jar" (
    echo é”™è¯¯: æœªæ‰¾åˆ° server.jar
    exit /b 1
)

:: æ¥å— EULAï¼ˆé¦–æ¬¡è¿è¡Œï¼‰
if not exist "eula.txt" (
    echo eula=true > eula.txt
    echo å·²è‡ªåŠ¨æ¥å— Minecraft EULA
)

:: å¯åŠ¨æœåŠ¡å™¨
echo æ­£åœ¨å¯åŠ¨ Minecraft æœåŠ¡å™¨...
java -Xms2G -Xmx4G ^
  -XX:+UseG1GC ^
  -XX:+ParallelRefProcEnabled ^
  -XX:MaxGCPauseMillis=200 ^
  -XX:+UnlockExperimentalVMOptions ^
  -XX:+DisableExplicitGC ^
  -XX:+AlwaysPreTouch ^
  -XX:G1NewSizePercent=30 ^
  -XX:G1MaxNewSizePercent=40 ^
  -XX:G1HeapRegionSize=8M ^
  -Dfile.encoding=UTF-8 ^
  -Duser.language=zh ^
  -Duser.country=CN ^
  -jar server.jar nogui

endlocal
```

#### **Forge/Fabric å¯åŠ¨è„šæœ¬**

**Forge (`start_forge.sh`):**
```bash
#!/bin/bash
cd /opt/minecraft/forge-server

# Forge é€šå¸¸ä¼šç”Ÿæˆ run.shï¼Œç›´æ¥ä½¿ç”¨
if [ -f "run.sh" ]; then
    chmod +x run.sh
    ./run.sh
else
    # æ‰‹åŠ¨å¯åŠ¨
    java -Xms2G -Xmx4G @libraries/net/minecraftforge/forge/*/unix_args.txt nogui
fi
```

**Fabric (`start_fabric.sh`):**
```bash
#!/bin/bash
cd /opt/minecraft/fabric-server

java -Xms2G -Xmx4G \
  -XX:+UseG1GC \
  -jar fabric-server-launch.jar nogui
```

### **é€‰æ‹©å»ºè®®**

#### **é€‰æ‹© java æ¨¡å¼ï¼Œå¦‚æœæ‚¨ï¼š**

- âœ… æ˜¯æ–°æ‰‹ï¼Œåˆšå¼€å§‹ä½¿ç”¨ NetherGate
- âœ… è¿è¡Œæ ‡å‡†çš„ Minecraft æœåŠ¡å™¨ï¼ˆPaper/Spigot/Vanillaï¼‰
- âœ… å¸Œæœ›é€šè¿‡ YAML é…ç½®æ–‡ä»¶ç®¡ç†æ‰€æœ‰å‚æ•°
- âœ… éœ€è¦è·¨å¹³å°ä¸€è‡´æ€§
- âœ… å¸Œæœ›ä½¿ç”¨ NetherGate çš„å®Œæ•´è¿›ç¨‹ç®¡ç†åŠŸèƒ½

#### **é€‰æ‹© script æ¨¡å¼ï¼Œå¦‚æœæ‚¨ï¼š**

- âœ… å·²ç»æœ‰æˆç†Ÿçš„å¯åŠ¨è„šæœ¬
- âœ… éœ€è¦å¤æ‚çš„å¯åŠ¨å‰/åå¤„ç†ï¼ˆå¦‚å¤‡ä»½ã€ç¯å¢ƒæ£€æµ‹ï¼‰
- âœ… ä½¿ç”¨ç¬¬ä¸‰æ–¹å¯åŠ¨å™¨ï¼ˆForgeã€Fabricã€Mohist ç­‰ï¼‰
- âœ… éœ€è¦é«˜åº¦è‡ªå®šä¹‰çš„å¯åŠ¨æµç¨‹
- âœ… éœ€è¦åœ¨è„šæœ¬ä¸­è®¾ç½®ç‰¹æ®Šç¯å¢ƒå˜é‡

#### **é€‰æ‹© external æ¨¡å¼ï¼Œå¦‚æœæ‚¨ï¼š**

- âœ… æœåŠ¡å™¨ç”±å…¶ä»–å·¥å…·ç®¡ç†ï¼ˆå¦‚ systemdã€Dockerï¼‰
- âœ… åªéœ€è¦ NetherGate çš„æ’ä»¶å’Œç®¡ç†åŠŸèƒ½
- âœ… è¿è¡Œåœ¨å—é™ç¯å¢ƒï¼ˆæ— æ³•ç›´æ¥ç®¡ç†è¿›ç¨‹ï¼‰
- âš ï¸ æ³¨æ„ï¼šå°†å¤±å»å´©æºƒæ£€æµ‹å’Œè‡ªåŠ¨é‡å¯åŠŸèƒ½

### **æœ€ä½³å®è·µ**

#### **1. è„šæœ¬æƒé™ï¼ˆLinux/macOSï¼‰**

```bash
# èµ‹äºˆè„šæœ¬æ‰§è¡Œæƒé™
chmod +x start.sh

# éªŒè¯æƒé™
ls -l start.sh
# è¾“å‡ºåº”åŒ…å« -rwxr-xr-x
```

#### **2. ç›¸å¯¹è·¯å¾„ vs ç»å¯¹è·¯å¾„**

```yaml
# âœ… æ¨èï¼šä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼ˆåŸºäº working_directoryï¼‰
script:
  path: ./start.sh
  working_directory: ./minecraft_server

# âœ… ä¹Ÿå¯ä»¥ï¼šä½¿ç”¨ç»å¯¹è·¯å¾„
script:
  path: /opt/minecraft/server/start.sh
  working_directory: /opt/minecraft/server

# âŒ é¿å…ï¼šæ··åˆä½¿ç”¨å¯èƒ½å¯¼è‡´æ··æ·†
script:
  path: /opt/minecraft/start.sh
  working_directory: ./server  # ä¸ä¸€è‡´
```

#### **3. è„šæœ¬å‚æ•°ä¼ é€’**

```yaml
# é…ç½®
script:
  path: ./start.sh
  arguments:
    - --config
    - custom.yml
    - --verbose

# ç›¸å½“äºæ‰§è¡Œ
./start.sh --config custom.yml --verbose
```

#### **4. ä½¿ç”¨ Shell ç‰¹æ€§ï¼ˆLinux/macOSï¼‰**

```yaml
# éœ€è¦ä½¿ç”¨ç®¡é“ã€é‡å®šå‘ç­‰ Shell ç‰¹æ€§æ—¶
script:
  use_shell: true
  path: "./start.sh | tee server.log"  # åŒæ—¶è¾“å‡ºåˆ°æ§åˆ¶å°å’Œæ–‡ä»¶
```

**æ³¨æ„**ï¼šé€šå¸¸ä¸éœ€è¦å¯ç”¨ `use_shell`ï¼Œé™¤éæ‚¨çš„è„šæœ¬åŒ…å« Shell ç‰¹æ€§ã€‚

---

## ğŸŒ SMP è¿æ¥é…ç½® (server_connection)

SMPï¼ˆServer Management Protocolï¼‰æ˜¯ NetherGate çš„é«˜çº§ç®¡ç†åè®®ï¼ŒåŸºäº WebSocket å’Œ JSON-RPC 2.0ã€‚

```yaml
server_connection:
  # SMP æœåŠ¡å™¨åœ°å€
  host: localhost
  
  # SMP ç«¯å£
  port: 40745
  
  # è®¤è¯å¯†é’¥ï¼ˆå¿…é¡»ä¸æœåŠ¡å™¨ç«¯ä¸€è‡´ï¼‰
  secret: ""
  
  # TLS é…ç½®
  use_tls: false
  tls_certificate: null
  tls_password: null
  
  # é‡è¿é…ç½®
  reconnect_interval: 5000      # é‡è¿é—´éš”ï¼ˆæ¯«ç§’ï¼‰
  heartbeat_timeout: 30000      # å¿ƒè·³è¶…æ—¶ï¼ˆæ¯«ç§’ï¼‰
  
  # è‡ªåŠ¨è¿æ¥
  auto_connect: true
  connect_delay: 3000           # è¿æ¥å»¶è¿Ÿï¼ˆæ¯«ç§’ï¼‰
  wait_for_server_ready: true   # ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨å®Œæˆ
```

### **é…ç½®é¡¹è¯´æ˜**

| é…ç½®é¡¹ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|--------|------|
| `host` | string | `"localhost"` | SMP æœåŠ¡å™¨åœ°å€ |
| `port` | number | `40745` | SMP ç«¯å£ï¼ˆå¯¹åº” `management-server-port`ï¼‰ |
| `secret` | string | `""` | è®¤è¯å¯†é’¥ï¼ˆå¯¹åº” `management-server-secret`ï¼‰ |
| `use_tls` | boolean | `false` | æ˜¯å¦ä½¿ç”¨ TLS åŠ å¯† |
| `reconnect_interval` | number | `5000` | é‡è¿é—´éš”ï¼ˆæ¯«ç§’ï¼‰ |
| `heartbeat_timeout` | number | `30000` | å¿ƒè·³è¶…æ—¶ï¼ˆæ¯«ç§’ï¼‰ |
| `auto_connect` | boolean | `true` | æ˜¯å¦è‡ªåŠ¨è¿æ¥ |
| `connect_delay` | number | `3000` | è¿æ¥å»¶è¿Ÿï¼ˆæ¯«ç§’ï¼‰ |
| `wait_for_server_ready` | boolean | `true` | æ˜¯å¦ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨å®Œæˆ |

### **å¯¹åº”çš„ server.properties é…ç½®**

```properties
# å¯ç”¨ SMP
management-server-enabled=true
management-server-host=localhost
management-server-port=40745
management-server-secret=<ä½ çš„40ä½è®¤è¯ä»¤ç‰Œ>
management-server-tls-enabled=false
```

### **ç”Ÿæˆè®¤è¯å¯†é’¥**

**Linux/macOS:**
```bash
openssl rand -base64 30 | tr -d '+/=' | cut -c1-40
```

**Windows PowerShell:**
```powershell
-join ((65..90) + (97..122) + (48..57) | Get-Random -Count 40 | % {[char]$_})
```

---

## ğŸ”§ RCON å®¢æˆ·ç«¯é…ç½® (rcon)

RCON ç”¨äºå‘ Minecraft æœåŠ¡å™¨å‘é€å‘½ä»¤ã€‚

```yaml
rcon:
  # æ˜¯å¦å¯ç”¨ RCON
  enabled: true
  
  # RCON æœåŠ¡å™¨åœ°å€
  host: localhost
  
  # RCON ç«¯å£
  port: 25566
  
  # RCON å¯†ç ï¼ˆå¿…é¡»ä¸ server.properties ä¸€è‡´ï¼‰
  password: ""
  
  # è¿æ¥è¶…æ—¶ï¼ˆæ¯«ç§’ï¼‰
  connect_timeout: 5000
  
  # å‘½ä»¤è¶…æ—¶ï¼ˆæ¯«ç§’ï¼‰
  command_timeout: 10000
  
  # è‡ªåŠ¨è¿æ¥
  auto_connect: true
  connect_delay: 3000
  
  # é‡è¿é…ç½®
  reconnect:
    enabled: true
    interval: 5000          # é‡è¿é—´éš”ï¼ˆæ¯«ç§’ï¼‰
    max_retries: 5          # æœ€å¤§é‡è¿æ¬¡æ•°
```

### **é…ç½®é¡¹è¯´æ˜**

| é…ç½®é¡¹ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|--------|------|
| `enabled` | boolean | `true` | æ˜¯å¦å¯ç”¨ RCON |
| `host` | string | `"localhost"` | RCON æœåŠ¡å™¨åœ°å€ |
| `port` | number | `25566` | RCON ç«¯å£ |
| `password` | string | `""` | RCON å¯†ç  |
| `connect_timeout` | number | `5000` | è¿æ¥è¶…æ—¶ï¼ˆæ¯«ç§’ï¼‰ |
| `command_timeout` | number | `10000` | å‘½ä»¤è¶…æ—¶ï¼ˆæ¯«ç§’ï¼‰ |
| `auto_connect` | boolean | `true` | æ˜¯å¦è‡ªåŠ¨è¿æ¥ |
| `connect_delay` | number | `3000` | è¿æ¥å»¶è¿Ÿï¼ˆæ¯«ç§’ï¼‰ |
| `reconnect.enabled` | boolean | `true` | æ˜¯å¦å¯ç”¨è‡ªåŠ¨é‡è¿ |
| `reconnect.interval` | number | `5000` | é‡è¿é—´éš”ï¼ˆæ¯«ç§’ï¼‰ |
| `reconnect.max_retries` | number | `5` | æœ€å¤§é‡è¿æ¬¡æ•° |

### **å¯¹åº”çš„ server.properties é…ç½®**

```properties
# å¯ç”¨ RCON
enable-rcon=true
rcon.port=25566
rcon.password=<ä½ çš„RCONå¯†ç >
```

---

## ğŸ“œ æ—¥å¿—ç›‘å¬å™¨é…ç½® (log_listener)

æ—¥å¿—ç›‘å¬å™¨ç”¨äºè§£æå’Œå¤„ç† Minecraft æœåŠ¡å™¨æ—¥å¿—ã€‚

```yaml
log_listener:
  # æ˜¯å¦å¯ç”¨æ—¥å¿—ç›‘å¬
  enabled: true
  
  # è§£æé…ç½®
  parsing:
    parse_chat: true          # è§£æèŠå¤©æ¶ˆæ¯
    parse_commands: true      # è§£æå‘½ä»¤
    parse_player_events: true # è§£æç©å®¶äº‹ä»¶ï¼ˆåŠ å…¥/ç¦»å¼€ï¼‰
    parse_errors: true        # è§£æé”™è¯¯ä¿¡æ¯
  
  # è¿‡æ»¤é…ç½®
  filters:
    ignore_patterns: []       # å¿½ç•¥çš„æ—¥å¿—æ¨¡å¼ï¼ˆæ­£åˆ™è¡¨è¾¾å¼ï¼‰
    log_levels:               # ç›‘å¬çš„æ—¥å¿—çº§åˆ«
      - INFO
      - WARN
      - ERROR
  
  # ç¼“å†²é…ç½®
  buffer:
    size: 1000                # ç¼“å†²åŒºå¤§å°
    drop_old: true            # ç¼“å†²åŒºæ»¡æ—¶ä¸¢å¼ƒæ—§æ—¥å¿—
```

---

## ğŸ”Œ æ’ä»¶ç®¡ç†é…ç½® (plugins)

```yaml
plugins:
  # æ’ä»¶ç›®å½•
  directory: plugins
  
  # æ˜¯å¦è‡ªåŠ¨åŠ è½½æ’ä»¶
  auto_load: true
  
  # æ˜¯å¦å¯ç”¨çƒ­é‡è½½
  hot_reload: true
  
  # å¯ç”¨çš„æ’ä»¶åˆ—è¡¨ï¼ˆ"*" è¡¨ç¤ºå…¨éƒ¨ï¼‰
  enabled_plugins:
    - "*"
  
  # ç¦ç”¨çš„æ’ä»¶åˆ—è¡¨
  disabled_plugins: []
  
  # æ˜¯å¦åœ¨æœåŠ¡å™¨å¯åŠ¨å®ŒæˆååŠ è½½æ’ä»¶
  load_after_server_ready: true
  
  # æ’ä»¶åŠ è½½è¶…æ—¶ï¼ˆç§’ï¼‰
  load_timeout: 30
  
  # ä¾èµ–ç®¡ç†é…ç½®
  dependency_management:
    enabled: true             # æ˜¯å¦å¯ç”¨ä¾èµ–ç®¡ç†
    auto_download: true       # æ˜¯å¦è‡ªåŠ¨ä¸‹è½½ç¼ºå¤±çš„ä¾èµ–
    nuget_sources:            # NuGet æºåˆ—è¡¨
      - https://api.nuget.org/v3/index.json
    download_timeout: 60      # ä¸‹è½½è¶…æ—¶ï¼ˆç§’ï¼‰
    verify_hash: true         # æ˜¯å¦éªŒè¯æ–‡ä»¶å“ˆå¸Œ
    conflict_resolution: highest  # å†²çªè§£å†³ç­–ç•¥ï¼šhighest | lowest | fail
    show_conflict_report: true    # æ˜¯å¦æ˜¾ç¤ºå†²çªæŠ¥å‘Š
```

### **ä¾èµ–ç®¡ç†è¯´æ˜**

NetherGate æ”¯æŒè‡ªåŠ¨ä¸‹è½½å’Œç®¡ç†æ’ä»¶çš„ NuGet ä¾èµ–ï¼š

- **`highest`** - ä½¿ç”¨æœ€é«˜ç‰ˆæœ¬ï¼ˆé»˜è®¤ï¼‰
- **`lowest`** - ä½¿ç”¨æœ€ä½å…¼å®¹ç‰ˆæœ¬
- **`fail`** - æ£€æµ‹åˆ°å†²çªæ—¶å¤±è´¥

---

## ğŸ“ æ—¥å¿—ç³»ç»Ÿé…ç½® (logging)

```yaml
logging:
  # æ—¥å¿—çº§åˆ«ï¼šDebug | Info | Warning | Error
  level: Info
  
  # æ§åˆ¶å°æ—¥å¿—é…ç½®
  console:
    enabled: true
    colored: true             # å½©è‰²è¾“å‡º
    show_server_output: true  # æ˜¾ç¤ºæœåŠ¡å™¨è¾“å‡º
    server_output_prefix: "[MC] "
  
  # æ–‡ä»¶æ—¥å¿—é…ç½®
  file:
    enabled: true
    path: logs/latest.log
    max_size: 10485760        # æœ€å¤§æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼Œé»˜è®¤ 10MBï¼‰
    max_files: 10             # ä¿ç•™çš„æ—¥å¿—æ–‡ä»¶æ•°é‡
    rolling: true             # æ˜¯å¦å¯ç”¨æ»šåŠ¨æ—¥å¿—
    encoding: UTF-8
  
  # é«˜çº§æ—¥å¿—é…ç½®
  advanced:
    log_plugin_loading: true      # è®°å½•æ’ä»¶åŠ è½½
    log_smp_communication: false  # è®°å½• SMP é€šä¿¡ï¼ˆè°ƒè¯•ç”¨ï¼‰
    log_rcon_communication: false # è®°å½• RCON é€šä¿¡ï¼ˆè°ƒè¯•ç”¨ï¼‰
    log_performance: false        # è®°å½•æ€§èƒ½ä¿¡æ¯
```

### **æ—¥å¿—çº§åˆ«è¯´æ˜**

| çº§åˆ« | è¯´æ˜ | ç”¨é€” |
|------|------|------|
| `Debug` | è°ƒè¯•ä¿¡æ¯ | å¼€å‘ç¯å¢ƒ |
| `Info` | ä¸€èˆ¬ä¿¡æ¯ | ç”Ÿäº§ç¯å¢ƒï¼ˆæ¨èï¼‰ |
| `Warning` | è­¦å‘Šä¿¡æ¯ | ç”Ÿäº§ç¯å¢ƒ |
| `Error` | é”™è¯¯ä¿¡æ¯ | ä»…é”™è¯¯ |

---

## âš¡ spark æ€§èƒ½ç›‘æ§é…ç½® (spark)

spark æ˜¯å¼ºå¤§çš„ Java åº”ç”¨æ€§èƒ½åˆ†æå·¥å…·ã€‚

```yaml
spark:
  # æ˜¯å¦å¯ç”¨ spark
  enabled: false
  
  # spark ç±»å‹ï¼šstandalone | plugin
  # standalone: ç‹¬ç«‹ä»£ç†ç‰ˆï¼ˆé€šè¿‡ -javaagent æ³¨å…¥ï¼‰
  # plugin: æ’ä»¶/æ¨¡ç»„ç‰ˆï¼ˆé€šè¿‡ RCON äº¤äº’ï¼‰
  type: standalone
  
  # æ˜¯å¦å¼ºåˆ¶åœ¨é java å¯åŠ¨æ¨¡å¼ä¸‹ä¹Ÿå°è¯•å¯ç”¨ spark
  # ä»…å¯¹ type=standalone æœ‰æ•ˆ
  # è­¦å‘Šï¼šè„šæœ¬æ¨¡å¼éœ€è¦è‡ªè¡Œåœ¨è„šæœ¬ä¸­æ·»åŠ  -javaagent å‚æ•°
  force_enable_for_script_mode: false
  
  # æ˜¯å¦è‡ªåŠ¨ä¸‹è½½ spark agentï¼ˆä»… standaloneï¼‰
  auto_download: true
  
  # spark agent jar æ–‡ä»¶è·¯å¾„ï¼ˆä»… standaloneï¼‰
  # å¦‚æœä¸ºç©ºä¸” auto_download=trueï¼Œå°†è‡ªåŠ¨ä¸‹è½½
  agent_jar: null
  
  # spark SSH ç›‘å¬ç«¯å£
  ssh_port: 2222
  
  # SSH å¯†ç ï¼ˆå¦‚æœä¸ºç©ºåˆ™ä½¿ç”¨éšæœºç”Ÿæˆçš„å¯†ç ï¼‰
  ssh_password: null
  
  # å¯åŠ¨æ—¶è‡ªåŠ¨å¼€å§‹æ€§èƒ½åˆ†æ
  auto_start_profiling: false
  
  # spark ç‰ˆæœ¬ï¼ˆç•™ç©ºä½¿ç”¨æœ€æ–°ç‰ˆæœ¬ï¼‰
  version: null
  
  # spark ä¸‹è½½åœ°å€
  download_url: https://spark.lucko.me/download/stable
```

---

## âš™ï¸ é«˜çº§é…ç½® (advanced)

```yaml
advanced:
  # æ€§èƒ½é…ç½®
  performance:
    enabled: false
    report_interval: 60       # æ€§èƒ½æŠ¥å‘Šé—´éš”ï¼ˆç§’ï¼‰
  
  # å®‰å…¨é…ç½®
  security:
    hide_secrets_in_logs: true  # éšè—æ—¥å¿—ä¸­çš„å¯†é’¥
    plugin_sandbox: false       # æ’ä»¶æ²™ç®±ï¼ˆå®éªŒæ€§ï¼‰
  
  # å®éªŒæ€§åŠŸèƒ½
  experimental:
    enabled: false
    hot_reload: false           # å®éªŒæ€§çƒ­é‡è½½
    web_interface: false        # Web ç®¡ç†ç•Œé¢
```

---

## ğŸŒ WebSocket æœåŠ¡å™¨é…ç½®

NetherGate å†…ç½® WebSocket æœåŠ¡å™¨ï¼Œç”¨äº Web ç®¡ç†é¢æ¿å’Œå®æ—¶ç›‘æ§ã€‚

> ğŸ“ **æ³¨æ„**ï¼šWebSocket é…ç½®**ç‹¬ç«‹äºä¸»é…ç½®æ–‡ä»¶**ï¼Œå­˜å‚¨åœ¨ `websocket-config.yaml` ä¸­ã€‚

### **é…ç½®æ–‡ä»¶ä½ç½®**

```
NetherGate/
â”œâ”€â”€ nethergate-config.yaml   # ä¸»é…ç½®æ–‡ä»¶
â””â”€â”€ websocket-config.yaml    # WebSocket é…ç½®æ–‡ä»¶ï¼ˆç‹¬ç«‹ï¼‰
```

### **é¦–æ¬¡å¯åŠ¨**

é¦–æ¬¡è¿è¡Œ NetherGate æ—¶ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆ `websocket-config.yaml` æ–‡ä»¶ï¼Œå¹¶è‡ªåŠ¨ç”Ÿæˆå®‰å…¨çš„è®¤è¯ä»¤ç‰Œã€‚

### **å®Œæ•´é…ç½®**

```yaml
# ============================================
# NetherGate WebSocket é…ç½®æ–‡ä»¶
# ============================================

# æ˜¯å¦å¯ç”¨ WebSocket æœåŠ¡å™¨
enabled: true

# ç›‘å¬åœ°å€ï¼ˆlocalhost æˆ– 0.0.0.0ï¼‰
host: localhost

# ç›‘å¬ç«¯å£
port: 8766

# æœ€å¤§è¿æ¥æ•°
max_connections: 100

# ============================================
# è®¤è¯é…ç½®
# ============================================
authentication:
  # æ˜¯å¦å¯ç”¨è®¤è¯
  enabled: true
  
  # è®¤è¯ä»¤ç‰Œï¼ˆé¦–æ¬¡å¯åŠ¨æ—¶è‡ªåŠ¨ç”Ÿæˆï¼‰
  token: "your-auto-generated-token-here"
  
  # ä»¤ç‰Œè¿‡æœŸæ—¶é—´ï¼ˆå°æ—¶ï¼‰
  token_expiry_hours: 24
  
  # å…è®¸çš„ IP åœ°å€åˆ—è¡¨ï¼ˆç©ºåˆ™å…è®¸æ‰€æœ‰ï¼‰
  allowed_ips: []
  
  # æ˜¯å¦è¦æ±‚ TLSï¼ˆHTTPS/WSSï¼‰
  require_tls: false

# ============================================
# CORS é…ç½®
# ============================================
cors:
  # æ˜¯å¦å¯ç”¨ CORS
  enabled: true
  
  # å…è®¸çš„æºï¼ˆ"*" è¡¨ç¤ºæ‰€æœ‰ï¼‰
  allowed_origins:
    - "*"

# ============================================
# å¿ƒè·³é…ç½®
# ============================================
heartbeat:
  # æ˜¯å¦å¯ç”¨å¿ƒè·³
  enabled: true
  
  # å¿ƒè·³é—´éš”ï¼ˆç§’ï¼‰
  interval_seconds: 30
  
  # è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
  timeout_seconds: 60

# ============================================
# ç¼“å†²åŒºé…ç½®
# ============================================
buffer:
  # æ¥æ”¶ç¼“å†²åŒºå¤§å°ï¼ˆå­—èŠ‚ï¼‰
  receive_buffer_size: 4096
  
  # å‘é€ç¼“å†²åŒºå¤§å°ï¼ˆå­—èŠ‚ï¼‰
  send_buffer_size: 4096
```

### **é…ç½®é¡¹è¯´æ˜**

#### **åŸºç¡€é…ç½®**

| é…ç½®é¡¹ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|--------|------|
| `enabled` | boolean | `true` | æ˜¯å¦å¯ç”¨ WebSocket æœåŠ¡å™¨ |
| `host` | string | `"localhost"` | ç›‘å¬åœ°å€ï¼ˆ`localhost` ä»…æœ¬åœ°ï¼Œ`0.0.0.0` æ‰€æœ‰ç½‘å¡ï¼‰ |
| `port` | number | `8766` | ç›‘å¬ç«¯å£ |
| `max_connections` | number | `100` | æœ€å¤§è¿æ¥æ•° |

#### **è®¤è¯é…ç½® (authentication)**

| é…ç½®é¡¹ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|--------|------|
| `enabled` | boolean | `true` | æ˜¯å¦å¯ç”¨è®¤è¯ |
| `token` | string | `""` | è®¤è¯ä»¤ç‰Œï¼ˆé¦–æ¬¡å¯åŠ¨æ—¶è‡ªåŠ¨ç”Ÿæˆï¼‰ |
| `token_expiry_hours` | number | `24` | ä»¤ç‰Œè¿‡æœŸæ—¶é—´ï¼ˆå°æ—¶ï¼‰ |
| `allowed_ips` | string[] | `[]` | å…è®¸çš„ IP åœ°å€åˆ—è¡¨ï¼ˆç©ºåˆ™å…è®¸æ‰€æœ‰ï¼‰ |
| `require_tls` | boolean | `false` | æ˜¯å¦è¦æ±‚ TLS åŠ å¯†è¿æ¥ |

#### **CORS é…ç½® (cors)**

| é…ç½®é¡¹ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|--------|------|
| `enabled` | boolean | `true` | æ˜¯å¦å¯ç”¨ CORS |
| `allowed_origins` | string[] | `["*"]` | å…è®¸çš„æºï¼ˆ`"*"` è¡¨ç¤ºæ‰€æœ‰ï¼‰ |

#### **å¿ƒè·³é…ç½® (heartbeat)**

| é…ç½®é¡¹ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|--------|------|
| `enabled` | boolean | `true` | æ˜¯å¦å¯ç”¨å¿ƒè·³ |
| `interval_seconds` | number | `30` | å¿ƒè·³é—´éš”ï¼ˆç§’ï¼‰ |
| `timeout_seconds` | number | `60` | è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰ |

#### **ç¼“å†²åŒºé…ç½® (buffer)**

| é…ç½®é¡¹ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|--------|------|
| `receive_buffer_size` | number | `4096` | æ¥æ”¶ç¼“å†²åŒºå¤§å°ï¼ˆå­—èŠ‚ï¼‰ |
| `send_buffer_size` | number | `4096` | å‘é€ç¼“å†²åŒºå¤§å°ï¼ˆå­—èŠ‚ï¼‰ |

---

### **ä½¿ç”¨åœºæ™¯**

#### **åœºæ™¯ 1: Web ç®¡ç†é¢æ¿**

ä¸º Web ç®¡ç†é¢æ¿æä¾›å®æ—¶æ•°æ®æ¨é€ã€‚

```yaml
enabled: true
host: 0.0.0.0  # å…è®¸å¤–éƒ¨è®¿é—®
port: 8766
authentication:
  enabled: true
  allowed_ips:
    - 192.168.1.0/24  # é™åˆ¶åˆ°å±€åŸŸç½‘
```

#### **åœºæ™¯ 2: ä»…æœ¬åœ°è®¿é—®**

ä»…å…è®¸æœ¬åœ°å·¥å…·è¿æ¥ã€‚

```yaml
enabled: true
host: localhost  # ä»…æœ¬åœ°è®¿é—®
port: 8766
authentication:
  enabled: true
```

#### **åœºæ™¯ 3: ç¦ç”¨ WebSocket**

å¦‚æœä¸éœ€è¦ WebSocket åŠŸèƒ½ã€‚

```yaml
enabled: false
```

---

### **å®‰å…¨å»ºè®®**

#### **1. ä½¿ç”¨å¼ºè®¤è¯ä»¤ç‰Œ**

- âœ… é¦–æ¬¡å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨ç”Ÿæˆ 64 ä½éšæœºä»¤ç‰Œ
- âœ… ä¸è¦ä½¿ç”¨ç®€å•çš„å¯†ç 
- âš ï¸ å®šæœŸæ›´æ¢ä»¤ç‰Œ

#### **2. é™åˆ¶è®¿é—® IP**

```yaml
authentication:
  allowed_ips:
    - 127.0.0.1        # ä»…æœ¬åœ°
    - 192.168.1.100    # ç‰¹å®š IP
    - 192.168.1.0/24   # å­ç½‘
```

#### **3. ä½¿ç”¨ TLSï¼ˆç”Ÿäº§ç¯å¢ƒæ¨èï¼‰**

```yaml
authentication:
  require_tls: true
```

é…åˆåå‘ä»£ç†ï¼ˆå¦‚ Nginxï¼‰å®ç° WSS åŠ å¯†è¿æ¥ã€‚

#### **4. é™åˆ¶æœ€å¤§è¿æ¥æ•°**

```yaml
max_connections: 10  # æ ¹æ®å®é™…éœ€è¦è°ƒæ•´
```

---

### **è¿æ¥ç¤ºä¾‹**

#### **JavaScript (æµè§ˆå™¨)**

```javascript
const ws = new WebSocket('ws://localhost:8766');

ws.onopen = () => {
  console.log('å·²è¿æ¥åˆ° NetherGate');
  
  // è®¤è¯
  ws.send(JSON.stringify({
    type: 'auth',
    requestId: '1',
    data: {
      token: 'your-token-here'
    }
  }));
};

ws.onmessage = (event) => {
  const message = JSON.parse(event.data);
  console.log('æ”¶åˆ°æ¶ˆæ¯:', message);
};
```

#### **Python**

```python
import asyncio
import websockets
import json

async def connect():
    uri = "ws://localhost:8766"
    async with websockets.connect(uri) as websocket:
        # è®¤è¯
        await websocket.send(json.dumps({
            "type": "auth",
            "requestId": "1",
            "data": {
                "token": "your-token-here"
            }
        }))
        
        # æ¥æ”¶æ¶ˆæ¯
        response = await websocket.recv()
        print(f"æ”¶åˆ°: {response}")

asyncio.run(connect())
```

---

### **å¸¸è§é—®é¢˜**

#### **Q: WebSocket ç«¯å£è¢«å ç”¨æ€ä¹ˆåŠï¼Ÿ**

**A**: ä¿®æ”¹ `port` é…ç½®ï¼š
```yaml
port: 9000  # æ›´æ”¹ä¸ºå…¶ä»–ç«¯å£
```

#### **Q: å¦‚ä½•æŸ¥çœ‹è‡ªåŠ¨ç”Ÿæˆçš„ä»¤ç‰Œï¼Ÿ**

**A**: æŸ¥çœ‹ `websocket-config.yaml` æ–‡ä»¶ä¸­çš„ `authentication.token` å­—æ®µã€‚

#### **Q: å¦‚ä½•é‡æ–°ç”Ÿæˆä»¤ç‰Œï¼Ÿ**

**A**: 
1. åˆ é™¤ `websocket-config.yaml` æ–‡ä»¶
2. é‡å¯ NetherGate
3. ç³»ç»Ÿä¼šè‡ªåŠ¨ç”Ÿæˆæ–°é…ç½®å’Œä»¤ç‰Œ

#### **Q: å¯ä»¥ç¦ç”¨è®¤è¯å—ï¼Ÿ**

**A**: å¯ä»¥ï¼Œä½†**ä¸æ¨è**ï¼ˆç‰¹åˆ«æ˜¯åœ¨ç”Ÿäº§ç¯å¢ƒï¼‰ï¼š
```yaml
authentication:
  enabled: false
```

---

### **WebSocket API å‚è€ƒ**

å®Œæ•´çš„ WebSocket API æ–‡æ¡£è¯·å‚è€ƒï¼š[WebSocket API æ–‡æ¡£](../04-é«˜çº§åŠŸèƒ½/WebSocketé›†æˆ.md)

---

## ğŸ“„ å®Œæ•´é…ç½®ç¤ºä¾‹

```yaml
# NetherGate ä¸»é…ç½®æ–‡ä»¶
# ç‰ˆæœ¬: 0.1.0

# ========== æœåŠ¡å™¨è¿›ç¨‹ç®¡ç† ==========
server_process:
  enabled: true
  launch_method: java
  
  java:
    path: java
    version_check: true
  
  server:
    jar: server.jar
    working_directory: ./minecraft_server
  
  memory:
    min: 2048
    max: 4096
  
  arguments:
    jvm_prefix: []
    jvm_middle:
      - -XX:+UseG1GC
      - -XX:+ParallelRefProcEnabled
      - -XX:MaxGCPauseMillis=200
      - -Dfile.encoding=UTF-8
    server:
      - --nogui
  
  script:
    path: ./start.sh
    arguments: []
    working_directory: ./minecraft_server
    use_shell: false
  
  monitoring:
    startup_timeout: 300
    show_server_output: true
    server_output_prefix: "[MC] "
    startup_detection:
      enabled: true
      keywords:
        - "Done ("
    crash_detection:
      enabled: true
      keywords:
        - "Exception in server tick loop"
  
  auto_restart:
    enabled: true
    delay_seconds: 5
    max_retries: 3
    retry_delay: 5000
    reset_timer: 600000

# ========== SMP è¿æ¥é…ç½® ==========
server_connection:
  host: localhost
  port: 40745
  secret: ""  # è¯·è®¾ç½®è®¤è¯å¯†é’¥
  use_tls: false
  tls_certificate: null
  tls_password: null
  reconnect_interval: 5000
  heartbeat_timeout: 30000
  auto_connect: true
  connect_delay: 3000
  wait_for_server_ready: true

# ========== RCON å®¢æˆ·ç«¯é…ç½® ==========
rcon:
  enabled: true
  host: localhost
  port: 25566
  password: ""  # è¯·è®¾ç½® RCON å¯†ç 
  connect_timeout: 5000
  command_timeout: 10000
  auto_connect: true
  connect_delay: 3000
  reconnect:
    enabled: true
    interval: 5000
    max_retries: 5

# ========== spark æ€§èƒ½ç›‘æ§é…ç½® ==========
spark:
  enabled: false
  type: standalone
  force_enable_for_script_mode: false
  auto_download: true
  agent_jar: null
  ssh_port: 2222
  ssh_password: null
  auto_start_profiling: false
  version: null
  download_url: https://spark.lucko.me/download/stable

# ========== æ—¥å¿—ç›‘å¬å™¨é…ç½® ==========
log_listener:
  enabled: true
  parsing:
    parse_chat: true
    parse_commands: true
    parse_player_events: true
    parse_errors: true
  filters:
    ignore_patterns: []
    log_levels:
      - INFO
      - WARN
      - ERROR
  buffer:
    size: 1000
    drop_old: true

# ========== æ’ä»¶ç®¡ç†é…ç½® ==========
plugins:
  directory: plugins
  auto_load: true
  hot_reload: true
  enabled_plugins:
    - "*"
  disabled_plugins: []
  load_after_server_ready: true
  load_timeout: 30
  dependency_management:
    enabled: true
    auto_download: true
    nuget_sources:
      - https://api.nuget.org/v3/index.json
    download_timeout: 60
    verify_hash: true
    conflict_resolution: highest
    show_conflict_report: true

# ========== æ—¥å¿—ç³»ç»Ÿé…ç½® ==========
logging:
  level: Info
  console:
    enabled: true
    colored: true
    show_server_output: true
    server_output_prefix: "[MC] "
  file:
    enabled: true
    path: logs/latest.log
    max_size: 10485760
    max_files: 10
    rolling: true
    encoding: UTF-8
  advanced:
    log_plugin_loading: true
    log_smp_communication: false
    log_rcon_communication: false
    log_performance: false

# ========== é«˜çº§é…ç½® ==========
advanced:
  performance:
    enabled: false
    report_interval: 60
  security:
    hide_secrets_in_logs: true
    plugin_sandbox: false
  experimental:
    enabled: false
    hot_reload: false
    web_interface: false
```

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [å®‰è£…å’Œé…ç½®](./å®‰è£…å’Œé…ç½®.md)
- [ç¬¬ä¸€ä¸ªæ’ä»¶](./ç¬¬ä¸€ä¸ªæ’ä»¶.md)
- [å†…ç½®å‘½ä»¤](../08-å‚è€ƒ/å†…ç½®å‘½ä»¤.md)
- [FAQ](../08-å‚è€ƒ/FAQ.md)

---

## â“ å¸¸è§é—®é¢˜

### **Q: å¦‚ä½•æ›´æ”¹é…ç½®æ–‡ä»¶æ ¼å¼ï¼Ÿ**

**A**: åˆ é™¤ç°æœ‰é…ç½®æ–‡ä»¶ï¼ŒNetherGate ä¼šè‡ªåŠ¨ç”Ÿæˆ YAML æ ¼å¼ã€‚æˆ–æ‰‹åŠ¨åˆ›å»ºæ‰€éœ€æ ¼å¼çš„æ–‡ä»¶ã€‚

---

### **Q: é…ç½®æ–‡ä»¶ä¿®æ”¹åéœ€è¦é‡å¯å—ï¼Ÿ**

**A**: æ˜¯çš„ï¼Œå¤§éƒ¨åˆ†é…ç½®é¡¹éœ€è¦é‡å¯ NetherGate æ‰èƒ½ç”Ÿæ•ˆã€‚

---

### **Q: external æ¨¡å¼ä¸‹å¦‚ä½•é…ç½®ï¼Ÿ**

**A**: 
```yaml
server_process:
  enabled: true
  launch_method: external
  server:
    working_directory: ./minecraft_server  # å¿…é¡»æŒ‡å®š
    
rcon:
  enabled: true
  # RCON é…ç½®...
  
server_connection:
  # SMP é…ç½®...
```

---

## ğŸ“Œ æœ€ä½³å®è·µ

### **1. å®‰å…¨é…ç½®**

- âœ… ä½¿ç”¨å¼ºå¯†é’¥
- âœ… é™åˆ¶ RCON å’Œ SMP ä»…æœ¬åœ°è®¿é—®
- âœ… å¯ç”¨ `hide_secrets_in_logs`

### **2. æ€§èƒ½ä¼˜åŒ–**

- âœ… æ ¹æ®æœåŠ¡å™¨è§„æ¨¡è°ƒæ•´å†…å­˜
- âœ… ä½¿ç”¨æ¨èçš„ JVM å‚æ•°
- âœ… å¯ç”¨ G1GCï¼ˆJava 8+ï¼‰

### **3. æ—¥å¿—ç®¡ç†**

- âœ… ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ `Info` çº§åˆ«
- âœ… å¼€å‘ç¯å¢ƒä½¿ç”¨ `Debug` çº§åˆ«
- âœ… å®šæœŸæ¸…ç†æ—§æ—¥å¿—æ–‡ä»¶

### **4. æ’ä»¶ç®¡ç†**

- âœ… å¼€å‘æ—¶å¯ç”¨çƒ­é‡è½½
- âœ… ç”Ÿäº§ç¯å¢ƒè°¨æ…ä½¿ç”¨çƒ­é‡è½½
- âœ… å®šæœŸå¤‡ä»½æ’ä»¶æ•°æ®

---

**æœ€åæ›´æ–°**: 2025-10-05  
**NetherGate ç‰ˆæœ¬**: v0.1.0  
**é…ç½®ç±»ç‰ˆæœ¬**: `NetherGateConfig.cs`
