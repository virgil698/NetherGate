# æ•…éšœæ’æŸ¥æŒ‡å—

æœ¬æ–‡æ¡£æä¾› NetherGate å¸¸è§é—®é¢˜çš„è¯Šæ–­å’Œè§£å†³æ–¹æ¡ˆã€‚

---

## ğŸ“‹ **ç›®å½•**

- [å¿«é€Ÿè¯Šæ–­](#å¿«é€Ÿè¯Šæ–­)
- [å¯åŠ¨é—®é¢˜](#å¯åŠ¨é—®é¢˜)
- [è¿æ¥é—®é¢˜](#è¿æ¥é—®é¢˜)
- [æ’ä»¶é—®é¢˜](#æ’ä»¶é—®é¢˜)
- [æ€§èƒ½é—®é¢˜](#æ€§èƒ½é—®é¢˜)
- [æ•°æ®é—®é¢˜](#æ•°æ®é—®é¢˜)

---

## ğŸ” **å¿«é€Ÿè¯Šæ–­**

### **æ£€æŸ¥æ¸…å•**

```bash
# 1. æ£€æŸ¥ .NET Runtime
dotnet --version
# åº”æ˜¾ç¤º: 9.0.x æˆ–æ›´é«˜

# 2. æ£€æŸ¥ Java
java -version
# åº”æ˜¾ç¤º: Java 21 æˆ–æ›´é«˜

# 3. æŸ¥çœ‹æ—¥å¿—
tail -f logs/latest.log

# 4. æ£€æŸ¥ç«¯å£å ç”¨
# Windows
netstat -ano | findstr "25575 25580"
# Linux
netstat -tulpn | grep "25575\|25580"

# 5. æ£€æŸ¥æ–‡ä»¶æƒé™ï¼ˆLinuxï¼‰
ls -la
# ç¡®ä¿æœ‰è¯»å†™æƒé™
```

### **å¸¸è§é”™è¯¯ä»£ç **

| é”™è¯¯ä»£ç  | è¯´æ˜ | è§£å†³æ–¹æ¡ˆ |
|---------|------|---------|
| `E001` | .NET Runtime æœªæ‰¾åˆ° | å®‰è£… .NET 9.0 |
| `E002` | é…ç½®æ–‡ä»¶æ ¼å¼é”™è¯¯ | æ£€æŸ¥ YAML è¯­æ³• |
| `E003` | RCON è¿æ¥å¤±è´¥ | æ£€æŸ¥å¯†ç å’Œç«¯å£ |
| `E004` | SMP è¿æ¥å¤±è´¥ | æ£€æŸ¥ auth_key |
| `E005` | æ’ä»¶åŠ è½½å¤±è´¥ | æ£€æŸ¥ plugin.json |

---

## ğŸš€ **å¯åŠ¨é—®é¢˜**

### **é—®é¢˜ï¼šNetherGate æ— æ³•å¯åŠ¨**

**é”™è¯¯ä¿¡æ¯ï¼š**
```
It was not possible to find any compatible framework version
The framework 'Microsoft.NETCore.App', version '9.0.0' was not found.
```

**è§£å†³æ–¹æ¡ˆï¼š**

1. **å®‰è£… .NET 9.0 Runtime**
   ```bash
   # ä¸‹è½½å¹¶å®‰è£…
   https://dotnet.microsoft.com/download/dotnet/9.0
   
   # éªŒè¯å®‰è£…
   dotnet --version
   ```

2. **æ£€æŸ¥ç¯å¢ƒå˜é‡**
   ```bash
   # Windows
   echo %PATH%
   # åº”åŒ…å«ï¼šC:\Program Files\dotnet\
   
   # Linux
   echo $PATH
   # åº”åŒ…å«ï¼š/usr/share/dotnet/
   ```

---

### **é—®é¢˜ï¼šé…ç½®æ–‡ä»¶åŠ è½½å¤±è´¥**

**é”™è¯¯ä¿¡æ¯ï¼š**
```
[ERROR] é…ç½®åŠ è½½å¤±è´¥: invalid yaml syntax
```

**è§£å†³æ–¹æ¡ˆï¼š**

1. **æ£€æŸ¥ YAML è¯­æ³•**
   ```yaml
   # âŒ é”™è¯¯ï¼šç¼©è¿›ä¸å¯¹
   server:
   working_directory: "path"
   
   # âœ… æ­£ç¡®
   server:
     working_directory: "path"
   ```

2. **ä½¿ç”¨ YAML éªŒè¯å™¨**
   - åœ¨çº¿å·¥å…·ï¼šhttps://yamllint.com/
   - æˆ–ä½¿ç”¨å‘½ä»¤ï¼š
     ```bash
     python -m yaml nethergate-config.yaml
     ```

3. **é‡æ–°ç”Ÿæˆé…ç½®**
   ```bash
   # åˆ é™¤é…ç½®æ–‡ä»¶
   rm nethergate-config.yaml
   
   # é‡æ–°å¯åŠ¨ï¼ˆä¼šç”Ÿæˆé»˜è®¤é…ç½®ï¼‰
   ./NetherGate.Host
   ```

---

### **é—®é¢˜ï¼šæœåŠ¡å™¨æ— æ³•å¯åŠ¨**

**é”™è¯¯ä¿¡æ¯ï¼š**
```
[ERROR] æœåŠ¡å™¨å¯åŠ¨å¤±è´¥: Cannot find server.jar
```

**è§£å†³æ–¹æ¡ˆï¼š**

1. **æ£€æŸ¥æ–‡ä»¶è·¯å¾„**
   ```yaml
   server:
     working_directory: "E:/Minecraft/Server"  # æ£€æŸ¥è·¯å¾„æ˜¯å¦æ­£ç¡®
     jar_file: "server.jar"  # æ£€æŸ¥æ–‡ä»¶åæ˜¯å¦æ­£ç¡®
   ```

2. **éªŒè¯æ–‡ä»¶å­˜åœ¨**
   ```bash
   # Windows
   dir "E:\Minecraft\Server\server.jar"
   
   # Linux
   ls -l /opt/minecraft/server/server.jar
   ```

3. **æ£€æŸ¥ Java**
   ```bash
   # æµ‹è¯•æ‰‹åŠ¨å¯åŠ¨
   cd /opt/minecraft/server
   java -jar server.jar nogui
   ```

---

## ğŸ”Œ **è¿æ¥é—®é¢˜**

### **é—®é¢˜ï¼šRCON è¿æ¥å¤±è´¥**

**é”™è¯¯ä¿¡æ¯ï¼š**
```
[ERROR] RCON è¿æ¥å¤±è´¥: Connection refused
```

**è¯Šæ–­æ­¥éª¤ï¼š**

```bash
# 1. æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦å¯åŠ¨
ps aux | grep java

# 2. æ£€æŸ¥ç«¯å£æ˜¯å¦ç›‘å¬
netstat -tulpn | grep 25575

# 3. æµ‹è¯• RCON è¿æ¥ï¼ˆä½¿ç”¨ mcrcon å·¥å…·ï¼‰
mcrcon -H 127.0.0.1 -P 25575 -p your_password "list"
```

**è§£å†³æ–¹æ¡ˆï¼š**

1. **æ£€æŸ¥ server.properties**
   ```properties
   enable-rcon=true
   rcon.port=25575
   rcon.password=your_password
   ```

2. **é‡å¯ Minecraft æœåŠ¡å™¨**
   - RCON é…ç½®æ›´æ”¹éœ€è¦é‡å¯

3. **æ£€æŸ¥é˜²ç«å¢™**
   ```bash
   # Linux
   sudo ufw allow 25575/tcp
   
   # Windows
   netsh advfirewall firewall add rule name="RCON" dir=in action=allow protocol=TCP localport=25575
   ```

4. **æ£€æŸ¥å¯†ç **
   ```yaml
   rcon:
     password: "your_password"  # å¿…é¡»ä¸ server.properties ä¸€è‡´
   ```

---

### **é—®é¢˜ï¼šSMP è¿æ¥å¤±è´¥**

**é”™è¯¯ä¿¡æ¯ï¼š**
```
[ERROR] SMP è¿æ¥å¤±è´¥: Authentication failed
```

**è¯Šæ–­æ­¥éª¤ï¼š**

```bash
# 1. æ£€æŸ¥ SMP æ’ä»¶æ˜¯å¦å®‰è£…
ls plugins/ | grep NetherGate-SMP

# 2. æ£€æŸ¥æœåŠ¡å™¨æ—¥å¿—
grep "NetherGate-SMP" logs/latest.log

# 3. æµ‹è¯• WebSocket è¿æ¥
wscat -c ws://localhost:25580
```

**è§£å†³æ–¹æ¡ˆï¼š**

1. **å®‰è£… SMP æ’ä»¶**
   - ä¸‹è½½å¯¹åº”ç‰ˆæœ¬çš„ SMP æ’ä»¶
   - æ”¾å…¥ plugins/ ç›®å½•
   - é‡å¯æœåŠ¡å™¨

2. **æ£€æŸ¥é…ç½®ä¸€è‡´æ€§**
   ```yaml
   # nethergate-config.yaml
   smp:
     auth_key: "secret_key_123"
   ```
   
   ```yaml
   # plugins/NetherGate-SMP/config.yml
   websocket:
     auth_key: "secret_key_123"  # å¿…é¡»ä¸€è‡´
   ```

3. **æ£€æŸ¥ç«¯å£**
   ```bash
   # ç¡®ä¿ç«¯å£æœªè¢«å ç”¨
   netstat -tulpn | grep 25580
   ```

---

## ğŸ”§ **æ’ä»¶é—®é¢˜**

### **é—®é¢˜ï¼šæ’ä»¶åŠ è½½å¤±è´¥**

**é”™è¯¯ä¿¡æ¯ï¼š**
```
[ERROR] æ’ä»¶åŠ è½½å¤±è´¥: Plugin entry point not found
```

**è¯Šæ–­æ­¥éª¤ï¼š**

1. **æ£€æŸ¥ plugin.json**
   ```json
   {
     "name": "MyPlugin",
     "entry_point": "MyPlugin.MyPlugin"  // å‘½åç©ºé—´.ç±»å
   }
   ```

2. **æ£€æŸ¥ç±»å®šä¹‰**
   ```csharp
   namespace MyPlugin  // ä¸ plugin.json ä¸­çš„å‘½åç©ºé—´ä¸€è‡´
   {
       public class MyPlugin : IPlugin  // ç±»åä¸€è‡´
       {
           // ...
       }
   }
   ```

3. **æ£€æŸ¥ DLL æ–‡ä»¶**
   ```bash
   ls plugins/MyPlugin/
   # åº”è¯¥æœ‰ MyPlugin.dll
   ```

**è§£å†³æ–¹æ¡ˆï¼š**

1. **é‡æ–°æ„å»ºæ’ä»¶**
   ```bash
   dotnet build --configuration Release
   ```

2. **æ£€æŸ¥è¾“å‡ºç›®å½•**
   - ç¡®ä¿ DLL å’Œ plugin.json éƒ½åœ¨ plugins/MyPlugin/ ç›®å½•

3. **æŸ¥çœ‹è¯¦ç»†æ—¥å¿—**
   ```yaml
   logging:
     level: "Debug"  # å¯ç”¨è¯¦ç»†æ—¥å¿—
   ```

---

### **é—®é¢˜ï¼šæ’ä»¶çƒ­é‡è½½å¤±è´¥**

**é”™è¯¯ä¿¡æ¯ï¼š**
```
[ERROR] æ’ä»¶é‡è½½å¤±è´¥: Assembly load error
```

**è§£å†³æ–¹æ¡ˆï¼š**

1. **ç¡®ä¿æ’ä»¶æ”¯æŒçƒ­é‡è½½**
   ```csharp
   public void OnDisable()
   {
       // å¿…é¡»æ­£ç¡®æ¸…ç†èµ„æº
       _timer?.Dispose();
       _context.EventBus.Unsubscribe(_handler);
   }
   ```

2. **æ£€æŸ¥é™æ€å˜é‡**
   ```csharp
   // âŒ é™æ€å˜é‡ä¸ä¼šé‡ç½®
   public static Dictionary<string, int> Cache = new();
   
   // âœ… åœ¨ OnDisable ä¸­æ¸…ç†
   public void OnDisable()
   {
       Cache.Clear();
   }
   ```

3. **æŸ¥çœ‹å †æ ˆè·Ÿè¸ª**
   ```bash
   grep "Assembly load error" -A 20 logs/latest.log
   ```

---

## âš¡ **æ€§èƒ½é—®é¢˜**

### **é—®é¢˜ï¼šNetherGate å ç”¨ CPU è¿‡é«˜**

**è¯Šæ–­æ­¥éª¤ï¼š**

```bash
# 1. æŸ¥çœ‹è¿›ç¨‹ CPU ä½¿ç”¨ç‡
# Windows
tasklist /FI "IMAGENAME eq NetherGate.Host.exe"

# Linux
top -p $(pgrep -f NetherGate.Host)

# 2. æŸ¥çœ‹çº¿ç¨‹
# Linux
ps -eLf | grep NetherGate.Host

# 3. æ€§èƒ½åˆ†æ
dotnet-trace collect --process-id <pid>
```

**è§£å†³æ–¹æ¡ˆï¼š**

1. **æ£€æŸ¥æ’ä»¶å¾ªç¯**
   ```csharp
   // âŒ æ­»å¾ªç¯
   while (true)
   {
       DoWork();  // æ²¡æœ‰å»¶è¿Ÿ
   }
   
   // âœ… ä½¿ç”¨å»¶è¿Ÿ
   while (true)
   {
       DoWork();
       await Task.Delay(1000);  // 1ç§’å»¶è¿Ÿ
   }
   ```

2. **æ£€æŸ¥äº‹ä»¶è®¢é˜…**
   ```csharp
   // âŒ äº‹ä»¶ä¸­æ‰§è¡Œè€—æ—¶æ“ä½œ
   _context.EventBus.Subscribe<PlayerJoinedEvent>(e =>
   {
       Thread.Sleep(5000);  // é˜»å¡ï¼
   });
   
   // âœ… ä½¿ç”¨å¼‚æ­¥
   _context.EventBus.Subscribe<PlayerJoinedEvent>(async e =>
   {
       await Task.Delay(5000);
   });
   ```

3. **ç¦ç”¨è°ƒè¯•æ—¥å¿—**
   ```yaml
   logging:
     level: "Info"  # ä¸è¦ç”¨ Debug
   ```

---

### **é—®é¢˜ï¼šå†…å­˜å ç”¨è¿‡é«˜**

**è¯Šæ–­æ­¥éª¤ï¼š**

```csharp
// åœ¨æ’ä»¶ä¸­æ·»åŠ å†…å­˜ç›‘æ§
var memoryMB = GC.GetTotalMemory(false) / 1024 / 1024;
_context.Logger.Info($"å†…å­˜ä½¿ç”¨: {memoryMB} MB");

GC.Collect();
var afterMB = GC.GetTotalMemory(true) / 1024 / 1024;
_context.Logger.Info($"å›æ”¶å: {afterMB} MB");
```

**è§£å†³æ–¹æ¡ˆï¼š**

1. **æ£€æŸ¥ç¼“å­˜**
   ```csharp
   // âŒ æ— é™å¢é•¿çš„ç¼“å­˜
   private Dictionary<string, PlayerData> _cache = new();
   
   // âœ… é™åˆ¶å¤§å°
   if (_cache.Count > 1000)
   {
       _cache.Clear();  // æˆ–ä½¿ç”¨ LRU ç¼“å­˜
   }
   ```

2. **æ£€æŸ¥äº‹ä»¶è®¢é˜…æ³„æ¼**
   ```csharp
   public void OnDisable()
   {
       // å¿…é¡»å–æ¶ˆè®¢é˜…
       _context.EventBus.Unsubscribe(_handler);
   }
   ```

3. **ä½¿ç”¨å¼±å¼•ç”¨**
   ```csharp
   private Dictionary<string, WeakReference<PlayerData>> _cache = new();
   ```

---

## ğŸ’¾ **æ•°æ®é—®é¢˜**

### **é—®é¢˜ï¼šç©å®¶æ•°æ®ä¸¢å¤±**

**è¯Šæ–­æ­¥éª¤ï¼š**

1. **æ£€æŸ¥ç©å®¶æ•°æ®æ–‡ä»¶**
   ```bash
   ls -lh world/playerdata/
   ```

2. **éªŒè¯ NBT æ•°æ®**
   ```bash
   # ä½¿ç”¨ NBT å·¥å…·
   nbt-dump world/playerdata/<uuid>.dat
   ```

3. **æ£€æŸ¥å¤‡ä»½**
   ```bash
   ls -lh backups/
   ```

**è§£å†³æ–¹æ¡ˆï¼š**

1. **ä»å¤‡ä»½æ¢å¤**
   ```bash
   # åœæ­¢æœåŠ¡å™¨
   stop
   
   # æ¢å¤å¤‡ä»½
   cp backups/latest/world/playerdata/<uuid>.dat world/playerdata/
   
   # é‡å¯æœåŠ¡å™¨
   ```

2. **ä¿®å¤æŸåçš„æ•°æ®**
   - ä½¿ç”¨ NBT ç¼–è¾‘å™¨
   - æˆ–ä½¿ç”¨æ’ä»¶ä¿®å¤å·¥å…·

---

### **é—®é¢˜ï¼šé…ç½®æ›´æ”¹ä¸ç”Ÿæ•ˆ**

**è§£å†³æ–¹æ¡ˆï¼š**

1. **é‡å¯ NetherGate**
   - æŸäº›é…ç½®éœ€è¦é‡å¯

2. **æ£€æŸ¥é…ç½®æ–‡ä»¶ä½ç½®**
   ```bash
   # ç¡®ä¿ä¿®æ”¹çš„æ˜¯æ­£ç¡®çš„é…ç½®æ–‡ä»¶
   pwd
   ls -la nethergate-config.yaml
   ```

3. **æ¸…é™¤ç¼“å­˜**
   ```bash
   rm -rf cache/
   ```

---

## ğŸ†˜ **è·å–å¸®åŠ©**

### **æäº¤ Bug æŠ¥å‘Š**

**éœ€è¦æä¾›çš„ä¿¡æ¯ï¼š**

1. **ç³»ç»Ÿä¿¡æ¯**
   ```bash
   # OS ç‰ˆæœ¬
   cat /etc/os-release  # Linux
   ver  # Windows
   
   # .NET ç‰ˆæœ¬
   dotnet --version
   
   # Java ç‰ˆæœ¬
   java -version
   ```

2. **NetherGate ç‰ˆæœ¬**
   ```bash
   ./NetherGate.Host --version
   ```

3. **æ—¥å¿—æ–‡ä»¶**
   ```bash
   # æœ€è¿‘çš„æ—¥å¿—
   tail -n 1000 logs/latest.log > bug-report.log
   ```

4. **é…ç½®æ–‡ä»¶**ï¼ˆç§»é™¤å¯†ç ï¼‰
   ```bash
   # å¤åˆ¶é…ç½®ï¼ˆè®°å¾—ç§»é™¤å¯†ç ï¼‰
   cp nethergate-config.yaml bug-report-config.yaml
   # ç¼–è¾‘ç§»é™¤æ•æ„Ÿä¿¡æ¯
   ```

5. **å¤ç°æ­¥éª¤**
   - è¯¦ç»†æè¿°å¦‚ä½•è§¦å‘é—®é¢˜
   - æä¾›æœ€å°å¤ç°ç¤ºä¾‹

### **ç¤¾åŒºæ”¯æŒ**

- **GitHub Issues**: https://github.com/your-org/NetherGate/issues
- **Discord**: https://discord.gg/example
- **æ–‡æ¡£**: https://nethergate.dev/docs
- **FAQ**: [å¸¸è§é—®é¢˜](../08-å‚è€ƒ/FAQ.md)

---

## ğŸ“š **ç›¸å…³æ–‡æ¡£**

- [FAQ](../08-å‚è€ƒ/FAQ.md)
- [é…ç½®æ–‡ä»¶è¯¦è§£](./é…ç½®æ–‡ä»¶è¯¦è§£.md)
- [è°ƒè¯•æŠ€å·§](../03-æ’ä»¶å¼€å‘/è°ƒè¯•æŠ€å·§.md)

---

**æ–‡æ¡£ç»´æŠ¤è€…ï¼š** NetherGate å¼€å‘å›¢é˜Ÿ  
**æœ€åæ›´æ–°ï¼š** 2025-10-05
